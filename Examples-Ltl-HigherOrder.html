<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Examples.Ltl.HigherOrder</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">graft-0.0.0</span><ul class="links" id="page-menu"><li><a href="src/Examples.Ltl.HigherOrder.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Examples.Ltl.HigherOrder</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Example domain specification</a></li><li><a href="#g:2">Using the effect system</a></li><li><a href="#g:3">Example programs in <code>MonadMiniLang</code></a><ul><li><a href="#g:4">Helper functions used in the example programs</a></li></ul></li><li><a href="#g:5">Defining single step modifications</a></li><li><a href="#g:6">Smart constructors of modifications</a></li><li><a href="#g:7">Running modified MiniLang programs</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>A tutorial for how to use <a href="Logic-Ltl.html">Logic.Ltl</a> with higher-order effects.
 The explanations here assume you've understood the simple tutorial in
 <a href="Examples-Ltl-Simple.html">Examples.Ltl.Simple</a>.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:MiniLangValue">MiniLangValue</a><ul class="subs"><li>= <a href="#v:MiniLangInteger">MiniLangInteger</a> <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a></li><li>| <a href="#v:MiniLangBoolean">MiniLangBoolean</a> <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:MiniLangError">MiniLangError</a><ul class="subs"><li>= <a href="#v:StackUnderflow">StackUnderflow</a></li><li>| <a href="#v:ExpectedBoolean">ExpectedBoolean</a></li><li>| <a href="#v:ExpectedInteger">ExpectedInteger</a></li></ul></li><li class="src short"><span class="keyword">class</span> <a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="#t:MonadMiniLang">MonadMiniLang</a> m <span class="keyword">where</span><ul class="subs"><li><a href="#v:push">push</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; m ()</li><li><a href="#v:pop">pop</a> :: m <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a></li><li><a href="#v:echo">echo</a> :: <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a> -&gt; m ()</li><li><a href="#v:if_">if_</a> :: m a -&gt; m a -&gt; m a</li><li><a href="#v:while_">while_</a> :: m () -&gt; m ()</li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:MiniLangT">MiniLangT</a> m = <a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Except.html#t:ExceptT" title="Control.Monad.Except">ExceptT</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Writer-Lazy.html#t:WriterT" title="Control.Monad.Writer.Lazy">WriterT</a> <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a> (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad-State-Lazy.html#t:StateT" title="Control.Monad.State.Lazy">StateT</a> [<a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a>] m))</li><li class="src short"><a href="#v:runMiniLangT">runMiniLangT</a> :: <a href="https://hackage.haskell.org/package/-/docs/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m =&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; m ((<a href="https://hackage.haskell.org/package/-/docs/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> a, <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a>), [<a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a>])</li><li class="src short"><span class="keyword">data</span> <a href="#t:MonadMiniLangEffect">MonadMiniLangEffect</a> :: <a href="Effect-Internal.html#t:Effect" title="Effect.Internal">Effect</a> <span class="keyword">where</span><ul class="subs"><li><a href="#v:Push">Push</a> :: <span class="keyword">forall</span> (m :: <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a>). <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> m ()</li><li><a href="#v:Pop">Pop</a> :: <span class="keyword">forall</span> (m :: <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a>). <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> m <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a></li><li><a href="#v:Echo">Echo</a> :: <span class="keyword">forall</span> (m :: <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a>). <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> m ()</li><li><a href="#v:If_">If_</a> :: <span class="keyword">forall</span> (m :: <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (a :: <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a>). (m a) -&gt; (m a) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> m a</li><li><a href="#v:While_">While_</a> :: <span class="keyword">forall</span> (m :: <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a>). (m ()) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> m ()</li></ul></li><li class="src short"><a href="#v:fibonacciExample">fibonacciExample</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> m, <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m) =&gt; <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; m <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a></li><li class="src short"><a href="#v:gcdExample">gcdExample</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> m, <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m) =&gt; <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; m <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a></li><li class="src short"><a href="#v:popInteger">popInteger</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> m, <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m) =&gt; m <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a></li><li class="src short"><a href="#v:pushInteger">pushInteger</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m =&gt; <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; m ()</li><li class="src short"><a href="#v:popBoolean">popBoolean</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> m, <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m) =&gt; m <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li><li class="src short"><a href="#v:pushBoolean">pushBoolean</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m =&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; m ()</li><li class="src short"><span class="keyword">data</span> <a href="#t:MiniLangMod">MiniLangMod</a> = <a href="#v:MiniLangMod">MiniLangMod</a> {<ul class="subs"><li><a href="#v:onPop">onPop</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a></li><li><a href="#v:onPush">onPush</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a></li></ul>}</li><li class="src short"><a href="#v:popBoolMiniLangMod">popBoolMiniLangMod</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a></li><li class="src short"><a href="#v:popIntegerMiniLangMod">popIntegerMiniLangMod</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a>) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a></li><li class="src short"><a href="#v:popMiniLangMod">popMiniLangMod</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; (<a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a>) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a></li><li class="src short"><a href="#v:pushBoolMiniLangMod">pushBoolMiniLangMod</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a></li><li class="src short"><a href="#v:pushIntegerMiniLangMod">pushIntegerMiniLangMod</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a>) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a></li><li class="src short"><a href="#v:pushMiniLangMod">pushMiniLangMod</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; (<a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a>) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a></li><li class="src short"><a href="#v:flipBools">flipBools</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a></li><li class="src short"><a href="#v:flipIntegers">flipIntegers</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a></li><li class="src short"><a href="#v:flipBoth">flipBoth</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a></li><li class="src short"><a href="#v:moduloMiniLangMod">moduloMiniLangMod</a> :: <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a></li><li class="src short"><a href="#v:interpretAndRunMiniLang">interpretAndRunMiniLang</a> :: <a href="Logic-Ltl.html#t:LtlAST" title="Logic.Ltl">LtlAST</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> '[<a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a>, <a href="Effect-Error.html#t:MonadErrorEffect" title="Effect.Error">MonadErrorEffect</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a>] a -&gt; [((<a href="https://hackage.haskell.org/package/-/docs/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> a, <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a>), [<a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a>])]</li><li class="src short"><a href="#v:exampleSomewhere">exampleSomewhere</a> :: [((<a href="https://hackage.haskell.org/package/-/docs/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a>, <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a>), [<a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a>])]</li><li class="src short"><a href="#v:exampleIf">exampleIf</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; [((<a href="https://hackage.haskell.org/package/-/docs/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> (), <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a>), [<a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a>])]</li><li class="src short"><a href="#v:exampleFlipFibonacci">exampleFlipFibonacci</a> :: <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Example domain specification</h1></a><div class="doc"><p>Our domain will be a low level, Turing-complete, abstract machine
 called <code><a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a></code> which is based on a stack of integers and
 booleans and can raise three different errors. Values can be popped
 and pushed, arbitrary text can be printed, and two control
 structures are present: <code><a href="Examples-Ltl-HigherOrder.html#v:if_" title="Examples.Ltl.HigherOrder">if_</a></code> and <code><a href="Examples-Ltl-HigherOrder.html#v:while_" title="Examples.Ltl.HigherOrder">while_</a></code>.</p><p>These two latter operations are what makes <code><a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a></code> a
 <em>higher order domain</em>: There are <em>nesting</em> operations, that is,
 operations that have sequences of operations in the same monad as
 parameters.</p><p>In Graft, nested operations must occur in <em>positive position</em> for
 conceptual and technical reasons. As a reminder, <code>x</code> is in
 <em>positive</em> position in <code>t</code> if it stands before an even number of
 <code>-&gt;</code>s, otherwise it is in <em>negative</em> position. A few examples:</p><ul><li>In <code>a -&gt; b</code>, <code>a</code> is in negative position, <code>b</code> in positive</li><li>position.</li><li>In <code>(a -&gt; b) -&gt; c</code>, <code>a</code> and <code>c</code> are in positive position, and <code>b</code>
   is in negative position.</li><li>In <code>Maybe ((a -&gt; [b]) -&gt; c) -&gt; d</code>, <code>d</code> and <code>b</code> are in positive
   position, and <code>a</code> and <code>c</code> are in negative position.</li></ul></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MiniLangValue" class="def">MiniLangValue</a> <a href="src/Examples.Ltl.HigherOrder.html#MiniLangValue" class="link">Source</a> <a href="#t:MiniLangValue" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MiniLangInteger" class="def">MiniLangInteger</a> <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:MiniLangBoolean" class="def">MiniLangBoolean</a> <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:MiniLangValue">Instances</h4><details id="i:MiniLangValue" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MiniLangValue:Show:1"></span> <a href="https://hackage.haskell.org/package/-/docs/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a></span> <a href="src/Examples.Ltl.HigherOrder.html#line-61" class="link">Source</a> <a href="#t:MiniLangValue" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MiniLangValue:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="https://hackage.haskell.org/package/-/docs/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a>] -&gt; <a href="https://hackage.haskell.org/package/-/docs/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MiniLangValue:Eq:2"></span> <a href="https://hackage.haskell.org/package/-/docs/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a></span> <a href="src/Examples.Ltl.HigherOrder.html#line-61" class="link">Source</a> <a href="#t:MiniLangValue" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MiniLangValue:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MiniLangValue:Alternative:3"></span> <a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m =&gt; <a href="https://hackage.haskell.org/package/-/docs/Control-Applicative.html#t:Alternative" title="Control.Applicative">Alternative</a> (<a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m)</span> <a href="src/Examples.Ltl.HigherOrder.html#line-119" class="link">Source</a> <a href="#t:MiniLangValue" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MiniLangValue:Alternative:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:empty">empty</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a <a href="#v:empty" class="selflink">#</a></p><p class="src"><a href="#v:-60--124--62-">(&lt;|&gt;)</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a <a href="#v:-60--124--62-" class="selflink">#</a></p><p class="src"><a href="#v:some">some</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m [a] <a href="#v:some" class="selflink">#</a></p><p class="src"><a href="#v:many">many</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m [a] <a href="#v:many" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MiniLangValue:MonadPlus:4"></span> <a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m =&gt; <a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> (<a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m)</span> <a href="src/Examples.Ltl.HigherOrder.html#line-124" class="link">Source</a> <a href="#t:MiniLangValue" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MiniLangValue:MonadPlus:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:mzero">mzero</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a <a href="#v:mzero" class="selflink">#</a></p><p class="src"><a href="#v:mplus">mplus</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a <a href="#v:mplus" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MiniLangValue:MonadMiniLang:5"></span> <a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> (<a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m)</span> <a href="src/Examples.Ltl.HigherOrder.html#line-90" class="link">Source</a> <a href="#t:MiniLangValue" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MiniLangValue:MonadMiniLang:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:push">push</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m () <a href="src/Examples.Ltl.HigherOrder.html#push" class="link">Source</a> <a href="#v:push" class="selflink">#</a></p><p class="src"><a href="#v:pop">pop</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> <a href="src/Examples.Ltl.HigherOrder.html#pop" class="link">Source</a> <a href="#v:pop" class="selflink">#</a></p><p class="src"><a href="#v:echo">echo</a> :: <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m () <a href="src/Examples.Ltl.HigherOrder.html#echo" class="link">Source</a> <a href="#v:echo" class="selflink">#</a></p><p class="src"><a href="#v:if_">if_</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a <a href="src/Examples.Ltl.HigherOrder.html#if_" class="link">Source</a> <a href="#v:if_" class="selflink">#</a></p><p class="src"><a href="#v:while_">while_</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m () -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m () <a href="src/Examples.Ltl.HigherOrder.html#while_" class="link">Source</a> <a href="#v:while_" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MiniLangError" class="def">MiniLangError</a> <a href="src/Examples.Ltl.HigherOrder.html#MiniLangError" class="link">Source</a> <a href="#t:MiniLangError" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:StackUnderflow" class="def">StackUnderflow</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:ExpectedBoolean" class="def">ExpectedBoolean</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:ExpectedInteger" class="def">ExpectedInteger</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:MiniLangError">Instances</h4><details id="i:MiniLangError" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MiniLangError:Show:1"></span> <a href="https://hackage.haskell.org/package/-/docs/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a></span> <a href="src/Examples.Ltl.HigherOrder.html#line-67" class="link">Source</a> <a href="#t:MiniLangError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MiniLangError:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="https://hackage.haskell.org/package/-/docs/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a>] -&gt; <a href="https://hackage.haskell.org/package/-/docs/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MiniLangError:Eq:2"></span> <a href="https://hackage.haskell.org/package/-/docs/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a></span> <a href="src/Examples.Ltl.HigherOrder.html#line-67" class="link">Source</a> <a href="#t:MiniLangError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MiniLangError:Eq:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MiniLangError:Alternative:3"></span> <a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m =&gt; <a href="https://hackage.haskell.org/package/-/docs/Control-Applicative.html#t:Alternative" title="Control.Applicative">Alternative</a> (<a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m)</span> <a href="src/Examples.Ltl.HigherOrder.html#line-119" class="link">Source</a> <a href="#t:MiniLangError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MiniLangError:Alternative:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:empty">empty</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a <a href="#v:empty" class="selflink">#</a></p><p class="src"><a href="#v:-60--124--62-">(&lt;|&gt;)</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a <a href="#v:-60--124--62-" class="selflink">#</a></p><p class="src"><a href="#v:some">some</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m [a] <a href="#v:some" class="selflink">#</a></p><p class="src"><a href="#v:many">many</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m [a] <a href="#v:many" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MiniLangError:MonadPlus:4"></span> <a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m =&gt; <a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> (<a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m)</span> <a href="src/Examples.Ltl.HigherOrder.html#line-124" class="link">Source</a> <a href="#t:MiniLangError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MiniLangError:MonadPlus:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:mzero">mzero</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a <a href="#v:mzero" class="selflink">#</a></p><p class="src"><a href="#v:mplus">mplus</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a <a href="#v:mplus" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MiniLangError:MonadMiniLang:5"></span> <a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> (<a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m)</span> <a href="src/Examples.Ltl.HigherOrder.html#line-90" class="link">Source</a> <a href="#t:MiniLangError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MiniLangError:MonadMiniLang:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:push">push</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m () <a href="src/Examples.Ltl.HigherOrder.html#push" class="link">Source</a> <a href="#v:push" class="selflink">#</a></p><p class="src"><a href="#v:pop">pop</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> <a href="src/Examples.Ltl.HigherOrder.html#pop" class="link">Source</a> <a href="#v:pop" class="selflink">#</a></p><p class="src"><a href="#v:echo">echo</a> :: <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m () <a href="src/Examples.Ltl.HigherOrder.html#echo" class="link">Source</a> <a href="#v:echo" class="selflink">#</a></p><p class="src"><a href="#v:if_">if_</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a <a href="src/Examples.Ltl.HigherOrder.html#if_" class="link">Source</a> <a href="#v:if_" class="selflink">#</a></p><p class="src"><a href="#v:while_">while_</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m () -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m () <a href="src/Examples.Ltl.HigherOrder.html#while_" class="link">Source</a> <a href="#v:while_" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a id="t:MonadMiniLang" class="def">MonadMiniLang</a> m <span class="keyword">where</span> <a href="src/Examples.Ltl.HigherOrder.html#MonadMiniLang" class="link">Source</a> <a href="#t:MonadMiniLang" class="selflink">#</a></p><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:push" class="def">push</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; m () <a href="src/Examples.Ltl.HigherOrder.html#push" class="link">Source</a> <a href="#v:push" class="selflink">#</a></p><p class="src"><a id="v:pop" class="def">pop</a> :: m <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> <a href="src/Examples.Ltl.HigherOrder.html#pop" class="link">Source</a> <a href="#v:pop" class="selflink">#</a></p><p class="src"><a id="v:echo" class="def">echo</a> :: <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a> -&gt; m () <a href="src/Examples.Ltl.HigherOrder.html#echo" class="link">Source</a> <a href="#v:echo" class="selflink">#</a></p><p class="src"><a id="v:if_" class="def">if_</a> :: m a -&gt; m a -&gt; m a <a href="src/Examples.Ltl.HigherOrder.html#if_" class="link">Source</a> <a href="#v:if_" class="selflink">#</a></p><p class="src"><a id="v:while_" class="def">while_</a> :: m () -&gt; m () <a href="src/Examples.Ltl.HigherOrder.html#while_" class="link">Source</a> <a href="#v:while_" class="selflink">#</a></p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:MonadMiniLang">Instances</h4><details id="i:MonadMiniLang" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:MonadMiniLang:MonadMiniLang:1"></span> ((), <a href="Effect-Internal.html#t:EffectInject" title="Effect.Internal">EffectInject</a> <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> ops) =&gt; <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> (<a href="Effect-Internal.html#t:AST" title="Effect.Internal">AST</a> ops)</span> <a href="src/Examples.Ltl.HigherOrder.html#line-134" class="link">Source</a> <a href="#t:MonadMiniLang" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:MonadMiniLang:MonadMiniLang:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:push">push</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="Effect-Internal.html#t:AST" title="Effect.Internal">AST</a> ops () <a href="src/Examples.Ltl.HigherOrder.html#push" class="link">Source</a> <a href="#v:push" class="selflink">#</a></p><p class="src"><a href="#v:pop">pop</a> :: <a href="Effect-Internal.html#t:AST" title="Effect.Internal">AST</a> ops <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> <a href="src/Examples.Ltl.HigherOrder.html#pop" class="link">Source</a> <a href="#v:pop" class="selflink">#</a></p><p class="src"><a href="#v:echo">echo</a> :: <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Effect-Internal.html#t:AST" title="Effect.Internal">AST</a> ops () <a href="src/Examples.Ltl.HigherOrder.html#echo" class="link">Source</a> <a href="#v:echo" class="selflink">#</a></p><p class="src"><a href="#v:if_">if_</a> :: <a href="Effect-Internal.html#t:AST" title="Effect.Internal">AST</a> ops a -&gt; <a href="Effect-Internal.html#t:AST" title="Effect.Internal">AST</a> ops a -&gt; <a href="Effect-Internal.html#t:AST" title="Effect.Internal">AST</a> ops a <a href="src/Examples.Ltl.HigherOrder.html#if_" class="link">Source</a> <a href="#v:if_" class="selflink">#</a></p><p class="src"><a href="#v:while_">while_</a> :: <a href="Effect-Internal.html#t:AST" title="Effect.Internal">AST</a> ops () -&gt; <a href="Effect-Internal.html#t:AST" title="Effect.Internal">AST</a> ops () <a href="src/Examples.Ltl.HigherOrder.html#while_" class="link">Source</a> <a href="#v:while_" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:MonadMiniLang:MonadMiniLang:2"></span> <a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> (<a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m)</span> <a href="src/Examples.Ltl.HigherOrder.html#line-90" class="link">Source</a> <a href="#t:MonadMiniLang" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:MonadMiniLang:MonadMiniLang:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:push">push</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m () <a href="src/Examples.Ltl.HigherOrder.html#push" class="link">Source</a> <a href="#v:push" class="selflink">#</a></p><p class="src"><a href="#v:pop">pop</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> <a href="src/Examples.Ltl.HigherOrder.html#pop" class="link">Source</a> <a href="#v:pop" class="selflink">#</a></p><p class="src"><a href="#v:echo">echo</a> :: <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m () <a href="src/Examples.Ltl.HigherOrder.html#echo" class="link">Source</a> <a href="#v:echo" class="selflink">#</a></p><p class="src"><a href="#v:if_">if_</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a <a href="src/Examples.Ltl.HigherOrder.html#if_" class="link">Source</a> <a href="#v:if_" class="selflink">#</a></p><p class="src"><a href="#v:while_">while_</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m () -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m () <a href="src/Examples.Ltl.HigherOrder.html#while_" class="link">Source</a> <a href="#v:while_" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="doc"><p>A concrete implementation for our domain: we use</p><ul><li>a list of values as inner state to account for the stack</li><li>a writer to allow printing strings using <code><a href="Examples-Ltl-HigherOrder.html#v:echo" title="Examples.Ltl.HigherOrder">echo</a></code></li><li>an exception to cover possible errors</li></ul></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:MiniLangT" class="def">MiniLangT</a> m = <a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Except.html#t:ExceptT" title="Control.Monad.Except">ExceptT</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Writer-Lazy.html#t:WriterT" title="Control.Monad.Writer.Lazy">WriterT</a> <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a> (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad-State-Lazy.html#t:StateT" title="Control.Monad.State.Lazy">StateT</a> [<a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a>] m)) <a href="src/Examples.Ltl.HigherOrder.html#MiniLangT" class="link">Source</a> <a href="#t:MiniLangT" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:runMiniLangT" class="def">runMiniLangT</a> :: <a href="https://hackage.haskell.org/package/-/docs/Data-Functor.html#t:Functor" title="Data.Functor">Functor</a> m =&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangT" title="Examples.Ltl.HigherOrder">MiniLangT</a> m a -&gt; m ((<a href="https://hackage.haskell.org/package/-/docs/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> a, <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a>), [<a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a>]) <a href="src/Examples.Ltl.HigherOrder.html#runMiniLangT" class="link">Source</a> <a href="#v:runMiniLangT" class="selflink">#</a></p></div><div class="doc"><p>As in the simple tutorial, the <code><a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a></code> instance is necessary
 boilerplate for the interpretation of <code><a href="Logic-Ltl.html#t:Ltl" title="Logic.Ltl">Ltl</a></code> formulas, since there
 might be several ways to satisfy one formula, and we want to try
 them all.</p></div><a href="#g:2" id="g:2"><h1>Using the effect system</h1></a><div class="doc"><p>To obtain the effects associated with <a href="MiniLang.html">MiniLang</a> for free, we call
 the same macros as in <a href="Examples-Ltl-Simple.html">Examples.Ltl.Simple</a> which also work in
 higher order settings.</p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MonadMiniLangEffect" class="def">MonadMiniLangEffect</a> :: <a href="Effect-Internal.html#t:Effect" title="Effect.Internal">Effect</a> <span class="keyword">where</span> <a href="src/Examples.Ltl.HigherOrder.html#MonadMiniLangEffect" class="link">Source</a> <a href="#t:MonadMiniLangEffect" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Push" class="def">Push</a> :: <span class="keyword">forall</span> (m :: <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a>). <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> m ()</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Pop" class="def">Pop</a> :: <span class="keyword">forall</span> (m :: <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a>). <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> m <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Echo" class="def">Echo</a> :: <span class="keyword">forall</span> (m :: <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a>). <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> m ()</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:If_" class="def">If_</a> :: <span class="keyword">forall</span> (m :: <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) (a :: <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a>). (m a) -&gt; (m a) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> m a</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:While_" class="def">While_</a> :: <span class="keyword">forall</span> (m :: <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Kind.html#t:Type" title="Data.Kind">Type</a>). (m ()) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> m ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:MonadMiniLangEffect">Instances</h4><details id="i:MonadMiniLangEffect" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MonadMiniLangEffect:InterpretEffect:1"></span> ((), <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m) =&gt; <a href="Effect-Internal.html#t:InterpretEffect" title="Effect.Internal">InterpretEffect</a> m <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a></span> <a href="src/Examples.Ltl.HigherOrder.html#line-134" class="link">Source</a> <a href="#t:MonadMiniLangEffect" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MonadMiniLangEffect:InterpretEffect:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:interpretEffect">interpretEffect</a> :: <span class="keyword">forall</span> (ops :: [<a href="Effect-Internal.html#t:Effect" title="Effect.Internal">Effect</a>]) a. (<span class="keyword">forall</span> b. <a href="Effect-Internal.html#t:AST" title="Effect.Internal">AST</a> ops b -&gt; m b) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> (<a href="Effect-Internal.html#t:AST" title="Effect.Internal">AST</a> ops) a -&gt; m a <a href="src/Effect.Internal.html#interpretEffect" class="link">Source</a> <a href="#v:interpretEffect" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MonadMiniLangEffect:InterpretLtlHigherOrder:2"></span> (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m, <a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> m, <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m) =&gt; <a href="Logic-Ltl.html#t:InterpretLtlHigherOrder" title="Logic.Ltl">InterpretLtlHigherOrder</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> m <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a></span> <a href="src/Examples.Ltl.HigherOrder.html#line-277" class="link">Source</a> <a href="#t:MonadMiniLangEffect" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MonadMiniLangEffect:InterpretLtlHigherOrder:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:interpretLtlHigherOrder">interpretLtlHigherOrder</a> :: <span class="keyword">forall</span> (ops :: [<a href="Effect-Internal.html#t:Effect" title="Effect.Internal">Effect</a>]) a. <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> (<a href="Effect-Internal.html#t:AST" title="Effect.Internal">AST</a> ops) a -&gt; <a href="Logic-Ltl.html#t:LtlInterpHigherOrder" title="Logic.Ltl">LtlInterpHigherOrder</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> m ops a <a href="src/Logic.Ltl.html#interpretLtlHigherOrder" class="link">Source</a> <a href="#v:interpretLtlHigherOrder" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:3" id="g:3"><h1>Example programs in <code>MonadMiniLang</code></h1></a><div class="top"><p class="src"><a id="v:fibonacciExample" class="def">fibonacciExample</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> m, <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m) =&gt; <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; m <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> <a href="src/Examples.Ltl.HigherOrder.html#fibonacciExample" class="link">Source</a> <a href="#v:fibonacciExample" class="selflink">#</a></p><div class="doc"><p>A program that computes the nth Fibonacci number.</p></div></div><div class="top"><p class="src"><a id="v:gcdExample" class="def">gcdExample</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> m, <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m) =&gt; <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; m <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> <a href="src/Examples.Ltl.HigherOrder.html#gcdExample" class="link">Source</a> <a href="#v:gcdExample" class="selflink">#</a></p><div class="doc"><p>A program that computes the greatest common divisor of two numbers.</p></div></div><a href="#g:4" id="g:4"><h2>Helper functions used in the example programs</h2></a><div class="top"><p class="src"><a id="v:popInteger" class="def">popInteger</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> m, <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m) =&gt; m <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> <a href="src/Examples.Ltl.HigherOrder.html#popInteger" class="link">Source</a> <a href="#v:popInteger" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pushInteger" class="def">pushInteger</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m =&gt; <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; m () <a href="src/Examples.Ltl.HigherOrder.html#pushInteger" class="link">Source</a> <a href="#v:pushInteger" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:popBoolean" class="def">popBoolean</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> m, <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m) =&gt; m <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Examples.Ltl.HigherOrder.html#popBoolean" class="link">Source</a> <a href="#v:popBoolean" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pushBoolean" class="def">pushBoolean</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m =&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; m () <a href="src/Examples.Ltl.HigherOrder.html#pushBoolean" class="link">Source</a> <a href="#v:pushBoolean" class="selflink">#</a></p></div><a href="#g:5" id="g:5"><h1>Defining single step modifications</h1></a><div class="doc"><p>Our type of modifications is a conjunction of a function to be
 applied before pushing a value, and a function to be applied after
 poping a value. To combine those within a Semigroup instance, we
 compose them while accounting for the fact that they can return
 <code><a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#v:Nothing" title="Data.Maybe">Nothing</a></code>.</p><p>Again, as explained in the simple tutorial, the
 <code><a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Semigroup" title="Prelude">Semigroup</a></code> instance is necessary because evaluation of <code><a href="Logic-Ltl.html#t:Ltl" title="Logic.Ltl">Ltl</a></code>
 formulas might sometimes make it necessary to apply more than one
 modification on the same operation.</p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:MiniLangMod" class="def">MiniLangMod</a> <a href="src/Examples.Ltl.HigherOrder.html#MiniLangMod" class="link">Source</a> <a href="#t:MiniLangMod" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MiniLangMod" class="def">MiniLangMod</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:onPop" class="def">onPop</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:onPush" class="def">onPush</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:MiniLangMod">Instances</h4><details id="i:MiniLangMod" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MiniLangMod:Semigroup:1"></span> <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Semigroup" title="Prelude">Semigroup</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a></span> <a href="src/Examples.Ltl.HigherOrder.html#line-211" class="link">Source</a> <a href="#t:MiniLangMod" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MiniLangMod:Semigroup:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-60--62-">(&lt;&gt;)</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> <a href="#v:-60--62-" class="selflink">#</a></p><p class="src"><a href="#v:sconcat">sconcat</a> :: <a href="https://hackage.haskell.org/package/-/docs/Data-List-NonEmpty.html#t:NonEmpty" title="Data.List.NonEmpty">NonEmpty</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> <a href="#v:sconcat" class="selflink">#</a></p><p class="src"><a href="#v:stimes">stimes</a> :: <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integral" title="Prelude">Integral</a> b =&gt; b -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> <a href="#v:stimes" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:MiniLangMod:InterpretLtlHigherOrder:2"></span> (<a href="https://hackage.haskell.org/package/-/docs/Control-Monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m, <a href="https://hackage.haskell.org/package/-/docs/Control-Monad-Error-Class.html#t:MonadError" title="Control.Monad.Error.Class">MonadError</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> m, <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a> m) =&gt; <a href="Logic-Ltl.html#t:InterpretLtlHigherOrder" title="Logic.Ltl">InterpretLtlHigherOrder</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> m <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a></span> <a href="src/Examples.Ltl.HigherOrder.html#line-277" class="link">Source</a> <a href="#t:MiniLangMod" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:MiniLangMod:InterpretLtlHigherOrder:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Examples-Ltl-HigherOrder.html">Examples.Ltl.HigherOrder</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:interpretLtlHigherOrder">interpretLtlHigherOrder</a> :: <span class="keyword">forall</span> (ops :: [<a href="Effect-Internal.html#t:Effect" title="Effect.Internal">Effect</a>]) a. <a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a> (<a href="Effect-Internal.html#t:AST" title="Effect.Internal">AST</a> ops) a -&gt; <a href="Logic-Ltl.html#t:LtlInterpHigherOrder" title="Logic.Ltl">LtlInterpHigherOrder</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> m ops a <a href="src/Logic.Ltl.html#interpretLtlHigherOrder" class="link">Source</a> <a href="#v:interpretLtlHigherOrder" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="doc"><p>Meaning is given to the single step modifications through their
 interpretation over our domain. This is what the class
 <code><a href="Logic-Ltl.html#t:InterpretLtlHigherOrder" title="Logic.Ltl">InterpretLtlHigherOrder</a></code> is for. There are two main differences
 with the first order case:</p><ul><li>The interpretation function directly handles <code><a href="Logic-Ltl.html#t:Ltl" title="Logic.Ltl">Ltl</a></code>
   formulas. (Remember that the <code><a href="Logic-SingleStep.html#t:InterpretMod" title="Logic.SingleStep">InterpretMod</a></code> instance in the
   simple tutorial only has to handle single-step modifications.)
   This is because the approach based on applying atomic
   modifications to single operations breaks down for higher-order
   operations: a single higher-order operation may contain sequences
   (<code>AST</code>s) of operations.</li><li>An explicit distinction needs to be made between first-order and
   higher-order effect constructors, by using <code><a href="Logic-Ltl.html#v:Direct" title="Logic.Ltl">Direct</a></code> and <code><a href="Logic-Ltl.html#v:Nested" title="Logic.Ltl">Nested</a></code>
   respectively.</li></ul><p>Considering the second difference:</p><ul><li>Using <code><a href="Logic-Ltl.html#v:Direct" title="Logic.Ltl">Direct</a></code> signals that the operation at hand is first order,
   and you can proceed as if writing an <code><a href="Logic-SingleStep.html#t:InterpretMod" title="Logic.SingleStep">InterpretMod</a></code> instance, as
   explained in the simple tutorial.</li><li>Using <code><a href="Logic-Ltl.html#v:Nested" title="Logic.Ltl">Nested</a></code> means the operation is of higher order. This case
   is detailed below.</li></ul><p>Handling higher order operations:</p><p>In the first order setting, we have the convenient class
 <code><a href="Logic-SingleStep.html#t:InterpretMod" title="Logic.SingleStep">InterpretMod</a></code> which allows us to specify how single-step
 modifications should be applied on operations. In the higher order
 setting the question is different: applying a single step
 modification on a nested operation makes no sense because it will
 likely contain several such operations, thus we provide the whole
 set of formulas to be applied currently and leave it to the user as
 to how they should be handling those. While it seems complicated,
 it is actually pretty straighforward in most cases as the user has
 sufficient domain knowledge to know how and when the nested blocks
 will be executed.</p><p>In the example:</p><p>Let's explain <code><a href="Examples-Ltl-HigherOrder.html#v:if_" title="Examples.Ltl.HigherOrder">if_</a></code> here. The typical behaviour of <code><a href="Examples-Ltl-HigherOrder.html#v:if_" title="Examples.Ltl.HigherOrder">if_</a></code> will be to
 evaluate the condition and pass the formula that modifies the
 remainder of the computation to either of the two branches,
 depending on whether the condition was true or false. In the case
 of our example, evaluation the condition is itself an operation,
 namely a <code><a href="Examples-Ltl-HigherOrder.html#v:pop" title="Examples.Ltl.HigherOrder">pop</a></code>. So, we will first consume the next single step
 modification and apply it to that <code><a href="Examples-Ltl-HigherOrder.html#v:pop" title="Examples.Ltl.HigherOrder">pop</a></code>. If that was successful,
 we'll pass on the remaining formulas to the correct block depending
 on the result of the (possibly modified) result of evaluating the
 condition.</p><p>Note how we use the function <code><a href="Logic-Ltl.html#v:nowLaterList" title="Logic.Ltl">nowLaterList</a></code> which, from a list of
 Ltl formulas, creates a list of pairs of a modification to be
 applied now and the remaining formulas. This function will likely
 often be called in higher order operations.</p></div><a href="#g:6" id="g:6"><h1>Smart constructors of modifications</h1></a><div class="top"><p class="src"><a id="v:popBoolMiniLangMod" class="def">popBoolMiniLangMod</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> <a href="src/Examples.Ltl.HigherOrder.html#popBoolMiniLangMod" class="link">Source</a> <a href="#v:popBoolMiniLangMod" class="selflink">#</a></p><div class="doc"><p>Modify boolean values on pop</p></div></div><div class="top"><p class="src"><a id="v:popIntegerMiniLangMod" class="def">popIntegerMiniLangMod</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a>) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> <a href="src/Examples.Ltl.HigherOrder.html#popIntegerMiniLangMod" class="link">Source</a> <a href="#v:popIntegerMiniLangMod" class="selflink">#</a></p><div class="doc"><p>Modify integer values on pop</p></div></div><div class="top"><p class="src"><a id="v:popMiniLangMod" class="def">popMiniLangMod</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; (<a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a>) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> <a href="src/Examples.Ltl.HigherOrder.html#popMiniLangMod" class="link">Source</a> <a href="#v:popMiniLangMod" class="selflink">#</a></p><div class="doc"><p>Modify all values on pop</p></div></div><div class="top"><p class="src"><a id="v:pushBoolMiniLangMod" class="def">pushBoolMiniLangMod</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> <a href="src/Examples.Ltl.HigherOrder.html#pushBoolMiniLangMod" class="link">Source</a> <a href="#v:pushBoolMiniLangMod" class="selflink">#</a></p><div class="doc"><p>Modify booleans on push</p></div></div><div class="top"><p class="src"><a id="v:pushIntegerMiniLangMod" class="def">pushIntegerMiniLangMod</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a>) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> <a href="src/Examples.Ltl.HigherOrder.html#pushIntegerMiniLangMod" class="link">Source</a> <a href="#v:pushIntegerMiniLangMod" class="selflink">#</a></p><div class="doc"><p>Modify integers on push</p></div></div><div class="top"><p class="src"><a id="v:pushMiniLangMod" class="def">pushMiniLangMod</a> :: (<a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; (<a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a>) -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> <a href="src/Examples.Ltl.HigherOrder.html#pushMiniLangMod" class="link">Source</a> <a href="#v:pushMiniLangMod" class="selflink">#</a></p><div class="doc"><p>Modify all values on push</p></div></div><div class="top"><p class="src"><a id="v:flipBools" class="def">flipBools</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> <a href="src/Examples.Ltl.HigherOrder.html#flipBools" class="link">Source</a> <a href="#v:flipBools" class="selflink">#</a></p><div class="doc"><p>Negate booleans on pop and push</p></div></div><div class="top"><p class="src"><a id="v:flipIntegers" class="def">flipIntegers</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> <a href="src/Examples.Ltl.HigherOrder.html#flipIntegers" class="link">Source</a> <a href="#v:flipIntegers" class="selflink">#</a></p><div class="doc"><p>Negate integers on pop and push</p></div></div><div class="top"><p class="src"><a id="v:flipBoth" class="def">flipBoth</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> <a href="src/Examples.Ltl.HigherOrder.html#flipBoth" class="link">Source</a> <a href="#v:flipBoth" class="selflink">#</a></p><div class="doc"><p>Negate all values on pop and push</p></div></div><div class="top"><p class="src"><a id="v:moduloMiniLangMod" class="def">moduloMiniLangMod</a> :: <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> <a href="src/Examples.Ltl.HigherOrder.html#moduloMiniLangMod" class="link">Source</a> <a href="#v:moduloMiniLangMod" class="selflink">#</a></p><div class="doc"><p>Apply the modulo operation on pop and push for integers</p></div></div><a href="#g:7" id="g:7"><h1>Running modified MiniLang programs</h1></a><div class="doc"><p>As in the simple tutorial, we can use the function
 <code><a href="Logic-Ltl.html#v:interpretLtlAST" title="Logic.Ltl">interpretLtlAST</a></code> to obtain a function that will interpret an
 <code><a href="Logic-Ltl.html#t:LtlAST" title="Logic.Ltl">LtlAST</a></code> of <code><a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a></code> and <code><a href="Effect-Error.html#t:MonadErrorEffect" title="Effect.Error">MonadErrorEffect</a></code>.</p><p>Note that the <code><a href="Logic-Ltl.html#t:LtlInstanceKind" title="Logic.Ltl">LtlInstanceKind</a></code> for the <code><a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a></code> is
 <code><a href="Logic-Ltl.html#v:InterpretLtlHigherOrderTag" title="Logic.Ltl">InterpretLtlHigherOrderTag</a></code>, since that's the instance that we
 implemented above: <code>InterpretLtlHigherOrder MiniLangMod m
 MonadMiniLangEffect</code>.</p><p>Again, the <code>InterpretEffectStateful</code> instance for <code>MonadErrorEffect
 MiniLangError</code> is the &quot;passthrough&quot; instance imported from
 <a href="Effect-Error-Passthtrough.html">Effect.Error.Passthtrough</a>, which ignores all modifications: We're
 only interested in modifying <code><a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a></code> operations in the
 program, not its generic error handling.</p></div><div class="top"><p class="src"><a id="v:interpretAndRunMiniLang" class="def">interpretAndRunMiniLang</a> :: <a href="Logic-Ltl.html#t:LtlAST" title="Logic.Ltl">LtlAST</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> '[<a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLangEffect" title="Examples.Ltl.HigherOrder">MonadMiniLangEffect</a>, <a href="Effect-Error.html#t:MonadErrorEffect" title="Effect.Error">MonadErrorEffect</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a>] a -&gt; [((<a href="https://hackage.haskell.org/package/-/docs/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> a, <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a>), [<a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a>])] <a href="src/Examples.Ltl.HigherOrder.html#interpretAndRunMiniLang" class="link">Source</a> <a href="#v:interpretAndRunMiniLang" class="selflink">#</a></p></div><div class="doc"><p>As in the simple simple tutorial, we can apply the <code><a href="Logic-Ltl.html#v:modifyLtl" title="Logic.Ltl">modifyLtl</a></code>
 function to modify the <code><a href="Examples-Ltl-HigherOrder.html#t:MonadMiniLang" title="Examples.Ltl.HigherOrder">MonadMiniLang</a></code> operations in the program.</p></div><div class="top"><p class="src"><a id="v:exampleSomewhere" class="def">exampleSomewhere</a> :: [((<a href="https://hackage.haskell.org/package/-/docs/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> <a href="https://hackage.haskell.org/package/-/docs/Prelude.html#t:Integer" title="Prelude">Integer</a>, <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a>), [<a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a>])] <a href="src/Examples.Ltl.HigherOrder.html#exampleSomewhere" class="link">Source</a> <a href="#v:exampleSomewhere" class="selflink">#</a></p></div><div class="doc"><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>exampleSomewhere
</code></strong>[((Right -42,&quot;Pushing 42&quot;),[]),
 ((Right -42,&quot;Pushing 42&quot;),[])]
</pre></div><div class="doc"><p>Let's look at a more interesting example with a higher-order
 operation, <code><a href="Examples-Ltl-HigherOrder.html#v:if_" title="Examples.Ltl.HigherOrder">if_</a></code>.</p></div><div class="top"><p class="src"><a id="v:exampleIf" class="def">exampleIf</a> :: <a href="Examples-Ltl-HigherOrder.html#t:MiniLangMod" title="Examples.Ltl.HigherOrder">MiniLangMod</a> -&gt; <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> -&gt; [((<a href="https://hackage.haskell.org/package/-/docs/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Examples-Ltl-HigherOrder.html#t:MiniLangError" title="Examples.Ltl.HigherOrder">MiniLangError</a> (), <a href="https://hackage.haskell.org/package/-/docs/Data-String.html#t:String" title="Data.String">String</a>), [<a href="Examples-Ltl-HigherOrder.html#t:MiniLangValue" title="Examples.Ltl.HigherOrder">MiniLangValue</a>])] <a href="src/Examples.Ltl.HigherOrder.html#exampleIf" class="link">Source</a> <a href="#v:exampleIf" class="selflink">#</a></p></div><div class="doc"><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>exampleIf flipIntegers True
</code></strong>[((Right (),&quot;&quot;),[MiniLangInteger (-42)]]
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>exampleIf flipIntegers False
</code></strong>[]
</pre><p>The two runs above show that we only modify the &quot;else&quot; branch of
 the <code><a href="Examples-Ltl-HigherOrder.html#v:if_" title="Examples.Ltl.HigherOrder">if_</a></code> when it is executed: in the second run, no modification
 is applied, because no push or pop involving an integer happens.</p><p>The next two runs are more involved, because we modify booleans,
 which are intrinsically very relevant for <code><a href="Examples-Ltl-HigherOrder.html#v:if_" title="Examples.Ltl.HigherOrder">if_</a></code>s. Let's mark the
 places that are potentially modified:</p><pre>do
  pushBoolean intOrBool    -- (1) because we push a boolean
  if_                      -- (2) because 'if_' pushes a boolean
    (pushInteger 42)
    (pushBoolean True)     -- (3) because we push a boolean</pre><p>The modality <code><a href="Logic-Ltl.html#v:somewhere" title="Logic.Ltl">somewhere</a></code> requires that we either modify the
 <code><a href="Examples-Ltl-HigherOrder.html#v:pushBoolean" title="Examples.Ltl.HigherOrder">pushBoolean</a></code> at (1), or modify some later <code><a href="Examples-Ltl-HigherOrder.html#v:push" title="Examples.Ltl.HigherOrder">push</a></code> or <code><a href="Examples-Ltl-HigherOrder.html#v:pop" title="Examples.Ltl.HigherOrder">pop</a></code> of a
 boolean. If <code>intOrBool</code> is initially <code><a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#v:True" title="Data.Bool">True</a></code>, that means we have two
 options:</p><ul><li>modify at (1), which means that the we'll <code><a href="Examples-Ltl-HigherOrder.html#v:pop" title="Examples.Ltl.HigherOrder">pop</a></code> a <code><a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#v:False" title="Data.Bool">False</a></code> at
   (2). In this scenario, we'll execute the 'else' branch, which
   will <code><a href="Examples-Ltl-HigherOrder.html#v:push" title="Examples.Ltl.HigherOrder">push</a></code> a <code><a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#v:True" title="Data.Bool">True</a></code> at (3).</li><li>modify at (2), which also means that we'll <code><a href="Examples-Ltl-HigherOrder.html#v:pop" title="Examples.Ltl.HigherOrder">pop</a></code> a <code><a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#v:False" title="Data.Bool">False</a></code> at
   (2). We'll consequently also execute the execute the 'else'
   branch, which will <code><a href="Examples-Ltl-HigherOrder.html#v:push" title="Examples.Ltl.HigherOrder">push</a></code> a <code><a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#v:True" title="Data.Bool">True</a></code> at (3).</li></ul><p>Note that we'll never apply a modification at (3), because in both
 cases, the requirements of <code><a href="Logic-Ltl.html#v:somewhere" title="Logic.Ltl">somewhere</a></code> are already satisfied.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>exampleIf flipBools True
</code></strong>[((Right (), &quot;&quot;), [MiniLangBoolean True]),
 ((Right (), &quot;&quot;), [MiniLangBoolean True])]
</pre><p>For our last run, let's look at the case where <code>intOrBool</code> is
 <code><a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#v:False" title="Data.Bool">False</a></code>. In that case, the following three scenarios are possible:</p><ul><li>modify at (1), which means that we'll <code><a href="Examples-Ltl-HigherOrder.html#v:pop" title="Examples.Ltl.HigherOrder">pop</a></code> a <code><a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#v:True" title="Data.Bool">True</a></code> at (2). So,
   we'll execute the 'then' branch, which will <code><a href="Examples-Ltl-HigherOrder.html#v:push" title="Examples.Ltl.HigherOrder">push</a></code> a '42'.</li><li>modify at (2), which means that we'll <code><a href="Examples-Ltl-HigherOrder.html#v:pop" title="Examples.Ltl.HigherOrder">pop</a></code> a <code><a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#v:True" title="Data.Bool">True</a></code> at (2). So,
   we'll execute the 'then' branch, which will <code><a href="Examples-Ltl-HigherOrder.html#v:push" title="Examples.Ltl.HigherOrder">push</a></code> a '42'.</li><li>If we don't modify at (1) or (2), we'll execute the 'else'
   branch, which will <code><a href="Examples-Ltl-HigherOrder.html#v:push" title="Examples.Ltl.HigherOrder">push</a></code> a <code><a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#v:False" title="Data.Bool">False</a></code> (modified from <code><a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#v:True" title="Data.Bool">True</a></code>) at
   (3).</li></ul><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>exampleIf flipBools False
</code></strong>[((Right (),&quot;&quot;),[MiniLangInteger 42]),
 ((Right (),&quot;&quot;),[MiniLangInteger 42]),
 ((Right (),&quot;&quot;),[MiniLangBoolean False])]
</pre></div><div class="doc"><p>Finally, for a more testing-flavoured example, we can check the
 property that the programs only interact with the stack through the
 <code><a href="Examples-Ltl-HigherOrder.html#v:push" title="Examples.Ltl.HigherOrder">push</a></code> and <code><a href="Examples-Ltl-HigherOrder.html#v:pop" title="Examples.Ltl.HigherOrder">pop</a></code> operations, by applying <code>everywhere
 flipBoth</code>. Effectively, this modification means that the entries on
 the stack will always be the inverse of their &quot;actual&quot; values, and
 that the meaning of <code><a href="Examples-Ltl-HigherOrder.html#v:push" title="Examples.Ltl.HigherOrder">push</a></code> and <code><a href="Examples-Ltl-HigherOrder.html#v:pop" title="Examples.Ltl.HigherOrder">pop</a></code> also contains reversing this
 polarity.</p></div><div class="top"><p class="src"><a id="v:exampleFlipFibonacci" class="def">exampleFlipFibonacci</a> :: <a href="https://hackage.haskell.org/package/-/docs/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="src/Examples.Ltl.HigherOrder.html#exampleFlipFibonacci" class="link">Source</a> <a href="#v:exampleFlipFibonacci" class="selflink">#</a></p></div><div class="doc"><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>exampleFlipFibonacci
</code></strong>True
</pre></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.27.0</p></div></body></html>