<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE EmptyCase #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-comment">-- | Generate state-aware modifications of sequences of stateful actions. The</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- approach is to use an LTL-inspired language to build /composite/</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- modifications that apply /atomic/ modifications to specific steps. Each</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- atomic modification's applicability and parameters may depend on the state</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- reached so far, and there will be zero or more possibilities to apply each</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- composite modification.</span><span>
</span><span id="line-24"></span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- The workflow is to</span><span>
</span><span id="line-26"></span><span class="hs-comment">--</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- - write effect types for all actions that you want to apply atomic</span><span>
</span><span id="line-28"></span><span class="hs-comment">--   modifications to,</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- - write an abstract type describing your atomic modifications, together with</span><span>
</span><span id="line-31"></span><span class="hs-comment">--   a 'Semigroup' instance that describes how they combine,</span><span>
</span><span id="line-32"></span><span class="hs-comment">--</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- - write instances of 'InterpretLtl' (or 'InterpretLtlHigherOrder' for</span><span>
</span><span id="line-34"></span><span class="hs-comment">--   higher-order effects) that explain how your atomic modifications apply to</span><span>
</span><span id="line-35"></span><span class="hs-comment">--   your effects,</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- Last reply today at 4:00 PM</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- - use 'modifyLtl' to apply composite modifications to your trace, and</span><span>
</span><span id="line-38"></span><span class="hs-comment">--</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- - use 'interpretLtlAST' to run all modified versions of your trace.</span><span>
</span><span id="line-40"></span><span class="hs-comment">--</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- The module &quot;Examples.Ltl.Simple&quot; contains a tutorial.</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- For historic context, this is a re-implementation of the &quot;LTL&quot; module from</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- cooked-validators. The version this is based upon is:</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- https://github.com/tweag/cooked-validators/blob/a460c1718d8d21bada510d83b705b24b0f8d36e0/src/Cooked/Ltl.hs</span><span>
</span><span id="line-46"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Logic.Ltl</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * 'Ltl' formulas</span></span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier">Ltl</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#somewhere"><span class="hs-identifier">somewhere</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#everywhere"><span class="hs-identifier">everywhere</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#there"><span class="hs-identifier">there</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Deploying 'Ltl' formulas</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#LtlAST"><span class="hs-identifier">LtlAST</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#modifyLtl"><span class="hs-identifier">modifyLtl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Higher-order effects</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#InterpretLtlHigherOrder"><span class="hs-identifier">InterpretLtlHigherOrder</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#LtlInterpHigherOrder"><span class="hs-identifier">LtlInterpHigherOrder</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#nowLaterList"><span class="hs-identifier">nowLaterList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#nowLaterSplit"><span class="hs-identifier">nowLaterSplit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Interpreting 'Ltl' modifications</span></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#LtlInstanceKind"><span class="hs-identifier">LtlInstanceKind</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtl"><span class="hs-identifier">InterpretEffectsLtl</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#interpretLtlAST"><span class="hs-identifier">interpretLtlAST</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#interpretLtlASTWithInitialFormulas"><span class="hs-identifier">interpretLtlASTWithInitialFormulas</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">where</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Const</span></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Effect.html"><span class="hs-identifier">Effect</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Effect.Internal.html"><span class="hs-identifier">Effect.Internal</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Logic.SingleStep.html"><span class="hs-identifier">Logic.SingleStep</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | Type of \&quot;LTL\&quot; formulas. Think of @a@ as a type of atomic</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- \&quot;modifications\&quot;, then a value of type @Ltl a@ describes a composite</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- modification that describes where to apply these modifications.</span><span>
</span><span id="line-82"></span><span class="hs-comment">--</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- Since it does not make (obvious) sense to talk of a negated modification or</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- of one modification (possibly in the future) to imply another modification,</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- implication and negation are absent.</span><span>
</span><span id="line-86"></span><span class="hs-keyword">data</span><span> </span><span id="Ltl"><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-var">Ltl</span></a></span></span><span> </span><span id="local-6989586621679188065"><span class="annot"><a href="#local-6989586621679188065"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-comment">-- | The &quot;do nothing&quot; modification that is always applicable</span></span><span>
</span><span id="line-88"></span><span>    </span><span id="LtlTruth"><span class="annot"><a href="Logic.Ltl.html#LtlTruth"><span class="hs-identifier hs-var">LtlTruth</span></a></span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | The modification that never applies</span></span><span>
</span><span id="line-90"></span><span>    </span><span id="LtlFalsity"><span class="annot"><a href="Logic.Ltl.html#LtlFalsity"><span class="hs-identifier hs-var">LtlFalsity</span></a></span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | The modification that applies a given atomic modification at the</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-comment">-- current step</span><span>
</span><span id="line-93"></span><span>    </span><span id="LtlAtom"><span class="annot"><a href="Logic.Ltl.html#LtlAtom"><span class="hs-identifier hs-var">LtlAtom</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679188065"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Branch into the \&quot;timeline\&quot; where the left modification is applied</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">-- and the one where the right modification is applied. (In a sense, this</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-comment">-- is an exclusive or, as we do not introduce the branch where both</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">-- modifications are applied.)</span><span>
</span><span id="line-98"></span><span>    </span><span id="LtlOr"><span class="annot"><a href="Logic.Ltl.html#LtlOr"><span class="hs-identifier hs-var">LtlOr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Apply both the left and the right modification. Attention: The \&quot;apply</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-comment">-- both\&quot; operation for  atomic modifications of type @a@ will be</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-comment">-- user-defined through a @'Semigroup'@ instance. If that operation</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-comment">-- isn't commutative, this conjunction may also fail to be commutative.</span><span>
</span><span id="line-103"></span><span>    </span><span id="LtlAnd"><span class="annot"><a href="Logic.Ltl.html#LtlAnd"><span class="hs-identifier hs-var">LtlAnd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Apply the given modification at the next step.</span></span><span>
</span><span id="line-105"></span><span>    </span><span id="LtlNext"><span class="annot"><a href="Logic.Ltl.html#LtlNext"><span class="hs-identifier hs-var">LtlNext</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Apply the first modification at least until the second one begins to</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-comment">-- be applicable (and is applied), which must happen eventually. The</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-comment">-- formulas</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-comment">-- &gt; a `LtlUntil` b</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-comment">-- and</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-comment">-- &gt; b `LtlOr` (a `LtlAnd` LtlNext (a `LtlUntil` b))</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- are equivalent.</span><span>
</span><span id="line-117"></span><span>    </span><span id="LtlUntil"><span class="annot"><a href="Logic.Ltl.html#LtlUntil"><span class="hs-identifier hs-var">LtlUntil</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Apply the second modification up to and including the step when the</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-comment">-- first one becomes applicable (and is applied); if that never happens,</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-comment">-- the second formula will be applied forever. View this as a dual to</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-comment">-- 'LtlUntil'. The formulas</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- &gt; a `LtlRelease` b</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-comment">-- and</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">-- &gt; b `LtlAnd` (a `LtlOr` LtlNext (a `LtlRelease` b))</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-comment">-- are equivalent.</span><span>
</span><span id="line-130"></span><span>    </span><span id="LtlRelease"><span class="annot"><a href="Logic.Ltl.html#LtlRelease"><span class="hs-identifier hs-var">LtlRelease</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188409"><span id="local-6989586621679188429"><span id="local-6989586621679188432"><span class="annot"><span class="annottext">Int -&gt; Ltl a -&gt; ShowS
[Ltl a] -&gt; ShowS
Ltl a -&gt; String
(Int -&gt; Ltl a -&gt; ShowS)
-&gt; (Ltl a -&gt; String) -&gt; ([Ltl a] -&gt; ShowS) -&gt; Show (Ltl a)
forall a. Show a =&gt; Int -&gt; Ltl a -&gt; ShowS
forall a. Show a =&gt; [Ltl a] -&gt; ShowS
forall a. Show a =&gt; Ltl a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Ltl a -&gt; ShowS
showsPrec :: Int -&gt; Ltl a -&gt; ShowS
$cshow :: forall a. Show a =&gt; Ltl a -&gt; String
show :: Ltl a -&gt; String
$cshowList :: forall a. Show a =&gt; [Ltl a] -&gt; ShowS
showList :: [Ltl a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><span class="hs-comment">-- | Apply an atomic modification to some action.</span></span><span>
</span><span id="line-134"></span><span id="local-6989586621679188063"><span class="annot"><a href="Logic.Ltl.html#somewhere"><span class="hs-identifier hs-type">somewhere</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679188063"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188063"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-135"></span><span id="somewhere"><span class="annot"><span class="annottext">somewhere :: forall a. a -&gt; Ltl a
</span><a href="Logic.Ltl.html#somewhere"><span class="hs-identifier hs-var hs-var">somewhere</span></a></span></span><span> </span><span id="local-6989586621679188435"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188435"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a
forall a. Ltl a
</span><a href="Logic.Ltl.html#LtlTruth"><span class="hs-identifier hs-var">LtlTruth</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlUntil"><span class="hs-operator hs-var">`LtlUntil`</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Ltl a
forall a. a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlAtom"><span class="hs-identifier hs-var">LtlAtom</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188435"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><span class="hs-comment">-- | Apply an atomic modification to all actions.</span></span><span>
</span><span id="line-138"></span><span id="local-6989586621679188436"><span class="annot"><a href="Logic.Ltl.html#everywhere"><span class="hs-identifier hs-type">everywhere</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679188436"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188436"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-139"></span><span id="everywhere"><span class="annot"><span class="annottext">everywhere :: forall a. a -&gt; Ltl a
</span><a href="Logic.Ltl.html#everywhere"><span class="hs-identifier hs-var hs-var">everywhere</span></a></span></span><span> </span><span id="local-6989586621679188437"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188437"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a
forall a. Ltl a
</span><a href="Logic.Ltl.html#LtlFalsity"><span class="hs-identifier hs-var">LtlFalsity</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlRelease"><span class="hs-operator hs-var">`LtlRelease`</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Ltl a
forall a. a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlAtom"><span class="hs-identifier hs-var">LtlAtom</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188437"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><span class="hs-comment">-- | Apply a modification from the n-th step in the trace (0-indexed).</span></span><span>
</span><span id="line-142"></span><span id="local-6989586621679188067"><span class="annot"><a href="Logic.Ltl.html#there"><span class="hs-identifier hs-type">there</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188067"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188067"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-143"></span><span id="there"><span class="annot"><span class="annottext">there :: forall a. Integer -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#there"><span class="hs-identifier hs-var hs-var">there</span></a></span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-144"></span><span class="annot"><a href="Logic.Ltl.html#there"><span class="hs-identifier hs-var">there</span></a></span><span> </span><span id="local-6989586621679188445"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679188445"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlNext"><span class="hs-identifier hs-var">LtlNext</span></a></span><span> </span><span class="annot"><span class="annottext">(Ltl a -&gt; Ltl a) -&gt; (Ltl a -&gt; Ltl a) -&gt; Ltl a -&gt; Ltl a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Ltl a -&gt; Ltl a
forall a. Integer -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#there"><span class="hs-identifier hs-var">there</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679188445"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><span class="hs-comment">-- | Internal: The effect type corresponding to 'modifyLtl'.</span></span><span>
</span><span id="line-147"></span><span class="hs-keyword">data</span><span> </span><span id="LtlEffect"><span class="annot"><a href="Logic.Ltl.html#LtlEffect"><span class="hs-identifier hs-var">LtlEffect</span></a></span></span><span> </span><span id="local-6989586621679188447"><span class="annot"><a href="#local-6989586621679188447"><span class="hs-identifier hs-type">mod</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188448"><span class="annot"><a href="#local-6989586621679188448"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188449"><span class="annot"><a href="#local-6989586621679188449"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679188092"><span id="local-6989586621679188093"><span id="local-6989586621679188094"><span id="ModifyLtl"><span class="annot"><a href="Logic.Ltl.html#ModifyLtl"><span class="hs-identifier hs-var">ModifyLtl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188092"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188093"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188094"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#LtlEffect"><span class="hs-identifier hs-type">LtlEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188092"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188093"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188094"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | An 'AST' that allows modifying parts of its contents with 'Ltl'</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- modifications, using 'modifyLtl'.</span><span>
</span><span id="line-152"></span><span class="hs-keyword">type</span><span> </span><span id="LtlAST"><span class="annot"><a href="Logic.Ltl.html#LtlAST"><span class="hs-identifier hs-var">LtlAST</span></a></span></span><span> </span><span id="local-6989586621679188451"><span class="annot"><a href="#local-6989586621679188451"><span class="hs-identifier hs-type">mod</span></a></span></span><span> </span><span id="local-6989586621679188452"><span class="annot"><a href="#local-6989586621679188452"><span class="hs-identifier hs-type">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Effect.Internal.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#LtlEffect"><span class="hs-identifier hs-type">LtlEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188451"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188452"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Apply an 'Ltl' modification to an 'LtlAST'. Think of @modifyLtl x acts@ as</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- &quot;try all ways to apply @x@ to the actions given in @acts@&quot;.</span><span>
</span><span id="line-156"></span><span id="local-6989586621679188074"><span id="local-6989586621679188075"><span id="local-6989586621679188076"><span class="annot"><a href="Logic.Ltl.html#modifyLtl"><span class="hs-identifier hs-type">modifyLtl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188074"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#LtlAST"><span class="hs-identifier hs-type">LtlAST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188074"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188075"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188076"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#LtlAST"><span class="hs-identifier hs-type">LtlAST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188074"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188075"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188076"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-157"></span><span id="modifyLtl"><span class="annot"><span class="annottext">modifyLtl :: forall mod (ops :: [(* -&gt; *) -&gt; * -&gt; *]) a.
Ltl mod -&gt; LtlAST mod ops a -&gt; LtlAST mod ops a
</span><a href="Logic.Ltl.html#modifyLtl"><span class="hs-identifier hs-var hs-var">modifyLtl</span></a></span></span><span> </span><span id="local-6989586621679188455"><span class="annot"><span class="annottext">Ltl mod
</span><a href="#local-6989586621679188455"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679188456"><span class="annot"><span class="annottext">LtlAST mod ops a
</span><a href="#local-6989586621679188456"><span class="hs-identifier hs-var">acts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LtlEffect mod (AST (LtlEffect mod : ops)) a -&gt; LtlAST mod ops a
forall (op :: (* -&gt; *) -&gt; * -&gt; *) (ops :: [(* -&gt; *) -&gt; * -&gt; *]) a.
EffectInject op ops =&gt;
op (AST ops) a -&gt; AST ops a
</span><a href="Effect.Internal.html#astInject"><span class="hs-identifier hs-var">astInject</span></a></span><span> </span><span class="annot"><span class="annottext">(LtlEffect mod (AST (LtlEffect mod : ops)) a -&gt; LtlAST mod ops a)
-&gt; LtlEffect mod (AST (LtlEffect mod : ops)) a -&gt; LtlAST mod ops a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ltl mod
-&gt; LtlAST mod ops a -&gt; LtlEffect mod (AST (LtlEffect mod : ops)) a
forall mod (m :: * -&gt; *) a. Ltl mod -&gt; m a -&gt; LtlEffect mod m a
</span><a href="Logic.Ltl.html#ModifyLtl"><span class="hs-identifier hs-var">ModifyLtl</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl mod
</span><a href="#local-6989586621679188455"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LtlAST mod ops a
</span><a href="#local-6989586621679188456"><span class="hs-identifier hs-var">acts</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- | Internal: We pass around a list of 'Ltl' modifications, with the intended</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- meaning that the first formula in the one that was added by the &quot;innermost&quot;</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- 'modifyLtl' (See 'nowLaterList' for how the list modification is applied</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- from step to step). Thus, what we have to do is to add the new formula upon</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- entering the block wrapped by 'ModifyLtl', and check that it's 'finished'</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- upon exiting.</span><span>
</span><span id="line-165"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-pragma">{-# OVERLAPPING</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679188108"><span id="local-6989586621679188109"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadPlus</span></span><span> </span><span class="annot"><a href="#local-6989586621679188108"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><a href="Effect.Internal.html#InterpretEffectStateful"><span class="hs-identifier hs-type">InterpretEffectStateful</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188109"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188108"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#LtlEffect"><span class="hs-identifier hs-type">LtlEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188109"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621679188472"><span class="annot"><span class="annottext">interpretEffectStateful :: forall (ops :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(forall b y.
 Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x
-&gt; LtlEffect mod (AST ops) a
-&gt; m (a, Const [Ltl mod] x)
</span><a href="#local-6989586621679188472"><span class="hs-identifier hs-var hs-var hs-var hs-var">interpretEffectStateful</span></a></span></span><span> </span><span id="local-6989586621679188474"><span class="annot"><span class="annottext">forall b y.
Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188474"><span class="hs-identifier hs-var">evalActs</span></a></span></span><span> </span><span id="local-6989586621679188475"><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188475"><span class="hs-identifier hs-var">ltls</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#ModifyLtl"><span class="hs-identifier hs-type">ModifyLtl</span></a></span><span> </span><span id="local-6989586621679188476"><span class="annot"><span class="annottext">Ltl mod
</span><a href="#local-6989586621679188476"><span class="hs-identifier hs-var">ltl</span></a></span></span><span> </span><span id="local-6989586621679188477"><span class="annot"><span class="annottext">AST ops a
</span><a href="#local-6989586621679188477"><span class="hs-identifier hs-var">acts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679188478"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188478"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span id="local-6989586621679188480"><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188480"><span class="hs-identifier hs-var">ltls'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] Any -&gt; AST ops a -&gt; m (a, Const [Ltl mod] Any)
forall b y.
Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188474"><span class="hs-identifier hs-var">evalActs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ltl mod] -&gt; Const [Ltl mod] Any
forall {k} a (b :: k). a -&gt; Const a b
</span><span class="hs-identifier hs-var">Const</span></span><span> </span><span class="annot"><span class="annottext">([Ltl mod] -&gt; Const [Ltl mod] Any)
-&gt; [Ltl mod] -&gt; Const [Ltl mod] Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ltl mod
</span><a href="#local-6989586621679188476"><span class="hs-identifier hs-var">ltl</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl mod -&gt; [Ltl mod] -&gt; [Ltl mod]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] x -&gt; [Ltl mod]
forall {k} a (b :: k). Const a b -&gt; a
</span><span class="hs-identifier hs-var">getConst</span></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188475"><span class="hs-identifier hs-var">ltls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AST ops a
</span><a href="#local-6989586621679188477"><span class="hs-identifier hs-var">acts</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Ltl mod -&gt; Bool
forall a. Ltl a -&gt; Bool
</span><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var">finished</span></a></span><span> </span><span class="annot"><span class="annottext">(Ltl mod -&gt; Bool) -&gt; ([Ltl mod] -&gt; Ltl mod) -&gt; [Ltl mod] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Ltl mod] -&gt; Ltl mod
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([Ltl mod] -&gt; Bool) -&gt; [Ltl mod] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188480"><span class="hs-identifier hs-var">ltls'</span></a></span><span>
</span><span id="line-173"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(a, Const [Ltl mod] x) -&gt; m (a, Const [Ltl mod] x)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188478"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ltl mod] -&gt; Const [Ltl mod] x
forall {k} a (b :: k). a -&gt; Const a b
</span><span class="hs-identifier hs-var">Const</span></span><span> </span><span class="annot"><span class="annottext">([Ltl mod] -&gt; Const [Ltl mod] x) -&gt; [Ltl mod] -&gt; Const [Ltl mod] x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Ltl mod] -&gt; [Ltl mod]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188480"><span class="hs-identifier hs-var">ltls'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">m (a, Const [Ltl mod] x)
forall a. m a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | Explain how to interpret an 'Ltl' modification, in the presence of</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- higher-order effects. The type parameters have the same meaning as for</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- 'InterpretLtl'.</span><span>
</span><span id="line-179"></span><span class="hs-keyword">class</span><span> </span><span id="InterpretLtlHigherOrder"><span class="annot"><a href="Logic.Ltl.html#InterpretLtlHigherOrder"><span class="hs-identifier hs-var">InterpretLtlHigherOrder</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188360"><span class="annot"><a href="#local-6989586621679188360"><span class="hs-identifier hs-type">mod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188361"><span class="annot"><a href="#local-6989586621679188361"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188362"><span class="annot"><a href="#local-6989586621679188362"><span class="hs-identifier hs-type">op</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Effect.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-comment">-- | Given an operation of type @op a@, there are two possibilities,</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">-- corresponding the two constructors of 'LtlInterpHigherOrder'.</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-comment">-- For simple operations that don't \&quot;nest\&quot; other 'AST's, use the</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-comment">-- 'Direct' constructor. Its meaning corresponds precisely to the</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-comment">-- 'interpretMod' function.</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-comment">-- For operations that /do/ nest, use the 'Nested' constructor. It needs some</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-comment">-- explanation: the stepwise approach based on applying atomic modifications</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-comment">-- to single operations breaks down for higher-order operations, since a</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-comment">-- single higher-order operation may contain 'AST's of operations. We'll</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-comment">-- likely want to use a composite modification while evaluating such nested</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-comment">-- 'AST's.</span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-comment">-- Composite modifications in the current setting are lists of 'Ltl'</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-comment">-- formulas, which are evaluated in parallel to the interpretation of the</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-comment">-- 'AST'. (Each 'modifyLtl' adds another formula to the head of that list. If</span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-comment">-- you don't nest 'modifyLtl's, the list will only ever contain one element.</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-comment">-- If you nest 'modifyLtl's, the head of the list will be the formula that</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-comment">-- was introduced by the innermost 'modifyLtl')</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-comment">-- The 'Nested' constructor proposes the following approach: It'll just give</span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-comment">-- you a function</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-comment">-- &gt; evalAST :: forall b. [Ltl mod] -&gt; AST ops b -&gt; m (b, [Ltl mod])</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-comment">-- which you can call on the nested 'AST's, which it'll evaluate with the</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-comment">-- list of 'Ltl' formulas you provide. To explain it by example, let's use</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-comment">-- 'ErrorEffect':</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-comment">-- &gt; instance (MonadError e m) =&gt; InterpretLtlHigherOrder x m (MonadErrorEffect e) where</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-comment">-- &gt;   interpretLtlHigherOrder (CatchError acts handler) =</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-comment">-- &gt;     Nested $ \evalAST ltls -&gt;</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-comment">-- &gt;       Just</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-comment">-- &gt;         &lt;$&gt; catchError</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-comment">-- &gt;           (evalAST ltls acts)</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-comment">-- &gt;           ( \err -&gt;</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-comment">-- &gt;               do</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-comment">-- &gt;                 (a, _) &lt;- evalAST [] $ handler err</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-comment">-- &gt;                 return (a, ltls)</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-comment">-- &gt;           )</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-comment">-- &gt;   interpretLtlHigherOrder (ThrowError err) = ...</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-comment">-- The equation for 'CatchError' means that you'll interpret the body @acts@</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-comment">-- with the composite modification currently in place. If any error is</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-comment">-- thrown, you'll run the @handler@, without any modifications at all, and</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-comment">-- restore the original composite modification. There might be other ways to</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-comment">-- implement this nesting behaviour, depending on your use case, and the</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-comment">-- 'Nested' constructor should hopefully be general enough to accommodate</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-comment">-- most of them. In particular, you can also return 'Nothing' from the</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-comment">-- 'Nested' constructor to signal that with the current composite modification,</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-comment">-- the operation can't be evaluated.</span><span>
</span><span id="line-232"></span><span>  </span><span id="interpretLtlHigherOrder"><span class="annot"><a href="Logic.Ltl.html#interpretLtlHigherOrder"><span class="hs-identifier hs-type">interpretLtlHigherOrder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679188358"><span id="local-6989586621679188359"><span class="annot"><a href="#local-6989586621679188362"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188358"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188359"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#LtlInterpHigherOrder"><span class="hs-identifier hs-type">LtlInterpHigherOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188360"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188361"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188358"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188359"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="annot"><span class="hs-comment">-- | codomain of 'interpretLtlHigherOrder'. See the explanation there.</span></span><span>
</span><span id="line-235"></span><span class="hs-keyword">data</span><span> </span><span id="LtlInterpHigherOrder"><span class="annot"><a href="Logic.Ltl.html#LtlInterpHigherOrder"><span class="hs-identifier hs-var">LtlInterpHigherOrder</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188487"><span class="annot"><a href="#local-6989586621679188487"><span class="hs-identifier hs-type">mod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188488"><span class="annot"><a href="#local-6989586621679188488"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188489"><span class="annot"><a href="#local-6989586621679188489"><span class="hs-identifier hs-type">ops</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Effect.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188490"><span class="annot"><a href="#local-6989586621679188490"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621679188491"><span id="local-6989586621679188492"><span id="local-6989586621679188493"><span id="local-6989586621679188494"><span id="Direct"><span class="annot"><a href="Logic.Ltl.html#Direct"><span class="hs-identifier hs-var">Direct</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logic.SingleStep.html#ModInterp"><span class="hs-identifier hs-type">ModInterp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188491"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188492"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188493"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#LtlInterpHigherOrder"><span class="hs-identifier hs-type">LtlInterpHigherOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188491"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188492"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188494"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188493"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621679188496"><span id="local-6989586621679188497"><span id="local-6989586621679188498"><span id="local-6989586621679188499"><span id="Nested"><span class="annot"><a href="Logic.Ltl.html#Nested"><span class="hs-identifier hs-var">Nested</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679188363"><span class="annot"><a href="#local-6989586621679188363"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188496"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effect.Internal.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188497"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188363"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188498"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188363"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188496"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-239"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188496"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><a href="#local-6989586621679188498"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188499"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188496"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#LtlInterpHigherOrder"><span class="hs-identifier hs-type">LtlInterpHigherOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188496"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188498"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188497"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188499"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | Used to signify which instance is to be used for a specific effect in the</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- 'InterpretEffectsLtl' class.</span><span>
</span><span id="line-246"></span><span class="hs-keyword">data</span><span> </span><span id="LtlInstanceKind"><span class="annot"><a href="Logic.Ltl.html#LtlInstanceKind"><span class="hs-identifier hs-var">LtlInstanceKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="InterpretModTag"><span class="annot"><a href="Logic.Ltl.html#InterpretModTag"><span class="hs-identifier hs-var">InterpretModTag</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="InterpretLtlHigherOrderTag"><span class="annot"><a href="Logic.Ltl.html#InterpretLtlHigherOrderTag"><span class="hs-identifier hs-var">InterpretLtlHigherOrderTag</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="InterpretEffectStatefulTag"><span class="annot"><a href="Logic.Ltl.html#InterpretEffectStatefulTag"><span class="hs-identifier hs-var">InterpretEffectStatefulTag</span></a></span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- | Internal: A reification of the 'InterpretEffectsLtl' constraint. This</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- works, because matching on the constructors will bring the constraint on the</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- constructor in scope. (This is what happens in the function</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- 'interpretJoinedEffectsLtl'.)</span><span>
</span><span id="line-252"></span><span class="hs-keyword">data</span><span> </span><span id="InterpretEffectsLtlConstraintList"><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlConstraintList"><span class="hs-identifier hs-var">InterpretEffectsLtlConstraintList</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188502"><span class="annot"><a href="#local-6989586621679188502"><span class="hs-identifier hs-type">mod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188503"><span class="annot"><a href="#local-6989586621679188503"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188504"><span class="annot"><a href="#local-6989586621679188504"><span class="hs-identifier hs-type">tags</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#LtlInstanceKind"><span class="hs-identifier hs-type">LtlInstanceKind</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188505"><span class="annot"><a href="#local-6989586621679188505"><span class="hs-identifier hs-type">ops</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Effect.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621679188506"><span id="local-6989586621679188507"><span id="InterpretEffectsLtlNil"><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlNil"><span class="hs-identifier hs-var">InterpretEffectsLtlNil</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlConstraintList"><span class="hs-identifier hs-type">InterpretEffectsLtlConstraintList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188506"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188507"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-254"></span><span>  </span><span id="local-6989586621679188152"><span id="local-6989586621679188154"><span id="local-6989586621679188509"><span id="local-6989586621679188510"><span id="local-6989586621679188511"><span id="InterpretEffectsLtlFirstorder"><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlFirstorder"><span class="hs-identifier hs-var">InterpretEffectsLtlFirstorder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#InterpretEffect"><span class="hs-identifier hs-type">InterpretEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188152"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188509"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Logic.SingleStep.html#InterpretMod"><span class="hs-identifier hs-type">InterpretMod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188154"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188152"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188509"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlConstraintList"><span class="hs-identifier hs-type">InterpretEffectsLtlConstraintList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188154"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188152"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188510"><span class="hs-identifier hs-type">tags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188511"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlConstraintList"><span class="hs-identifier hs-type">InterpretEffectsLtlConstraintList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188154"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188152"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#InterpretModTag"><span class="hs-identifier hs-type">InterpretModTag</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188510"><span class="hs-identifier hs-type">tags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188509"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188511"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621679188169"><span id="local-6989586621679188170"><span id="local-6989586621679188513"><span id="local-6989586621679188514"><span id="local-6989586621679188515"><span id="InterpretEffectsLtlHigherorder"><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlHigherorder"><span class="hs-identifier hs-var">InterpretEffectsLtlHigherorder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#InterpretEffect"><span class="hs-identifier hs-type">InterpretEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188169"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188513"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Logic.Ltl.html#InterpretLtlHigherOrder"><span class="hs-identifier hs-type">InterpretLtlHigherOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188170"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188169"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188513"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlConstraintList"><span class="hs-identifier hs-type">InterpretEffectsLtlConstraintList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188170"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188169"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188514"><span class="hs-identifier hs-type">tags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188515"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlConstraintList"><span class="hs-identifier hs-type">InterpretEffectsLtlConstraintList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188170"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188169"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#InterpretLtlHigherOrderTag"><span class="hs-identifier hs-type">InterpretLtlHigherOrderTag</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188514"><span class="hs-identifier hs-type">tags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188513"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188515"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621679188182"><span id="local-6989586621679188183"><span id="local-6989586621679188517"><span id="local-6989586621679188518"><span id="local-6989586621679188519"><span id="InterpretEffectsLtlEffectStateful"><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlEffectStateful"><span class="hs-identifier hs-var">InterpretEffectsLtlEffectStateful</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#InterpretEffectStateful"><span class="hs-identifier hs-type">InterpretEffectStateful</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188182"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188183"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188517"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlConstraintList"><span class="hs-identifier hs-type">InterpretEffectsLtlConstraintList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188182"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188183"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188518"><span class="hs-identifier hs-type">tags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188519"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlConstraintList"><span class="hs-identifier hs-type">InterpretEffectsLtlConstraintList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188182"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188183"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectStatefulTag"><span class="hs-identifier hs-type">InterpretEffectStatefulTag</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188518"><span class="hs-identifier hs-type">tags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188517"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188519"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- | The constraint used by 'interpretLtlASt' and similar functions. See the documentation there.</span><span>
</span><span id="line-268"></span><span class="hs-comment">--</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- Users of the library will /never/ have to write instances of this class.</span><span>
</span><span id="line-270"></span><span class="hs-keyword">class</span><span> </span><span id="InterpretEffectsLtl"><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtl"><span class="hs-identifier hs-var">InterpretEffectsLtl</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188133"><span class="annot"><a href="#local-6989586621679188133"><span class="hs-identifier hs-type">mod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188134"><span class="annot"><a href="#local-6989586621679188134"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188135"><span class="annot"><a href="#local-6989586621679188135"><span class="hs-identifier hs-type">tags</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#LtlInstanceKind"><span class="hs-identifier hs-type">LtlInstanceKind</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188136"><span class="annot"><a href="#local-6989586621679188136"><span class="hs-identifier hs-type">ops</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Effect.Internal.html#Effect"><span class="hs-identifier hs-type">Effect</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-comment">-- | A witness of the constraint.</span><span>
</span><span id="line-272"></span><span>  </span><span id="interpretEffectsLtl"><span class="annot"><a href="Logic.Ltl.html#interpretEffectsLtl"><span class="hs-identifier hs-type">interpretEffectsLtl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlConstraintList"><span class="hs-identifier hs-type">InterpretEffectsLtlConstraintList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188133"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188134"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188135"><span class="hs-identifier hs-type">tags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188136"><span class="hs-identifier hs-type">ops</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679188137"><span id="local-6989586621679188138"><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtl"><span class="hs-identifier hs-type">InterpretEffectsLtl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188137"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188138"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>  </span><span id="local-6989586621679188525"><span class="annot"><span class="annottext">interpretEffectsLtl :: InterpretEffectsLtlConstraintList mod m '[] '[]
</span><a href="Logic.Ltl.html#interpretEffectsLtl"><span class="hs-identifier hs-var hs-var hs-var hs-var">interpretEffectsLtl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m '[] '[]
forall mod (m :: * -&gt; *).
InterpretEffectsLtlConstraintList mod m '[] '[]
</span><a href="Logic.Ltl.html#InterpretEffectsLtlNil"><span class="hs-identifier hs-var">InterpretEffectsLtlNil</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679188147"><span id="local-6989586621679188148"><span id="local-6989586621679188149"><span id="local-6989586621679188150"><span id="local-6989586621679188151"><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#InterpretEffect"><span class="hs-identifier hs-type">InterpretEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188147"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188148"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Logic.SingleStep.html#InterpretMod"><span class="hs-identifier hs-type">InterpretMod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188149"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188147"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188148"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtl"><span class="hs-identifier hs-type">InterpretEffectsLtl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188149"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188147"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188150"><span class="hs-identifier hs-type">tags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188151"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtl"><span class="hs-identifier hs-type">InterpretEffectsLtl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188149"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188147"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#InterpretModTag"><span class="hs-identifier hs-type">InterpretModTag</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188150"><span class="hs-identifier hs-type">tags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188148"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188151"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-278"></span><span>  </span><span id="local-6989586621679188534"><span class="annot"><span class="annottext">interpretEffectsLtl :: InterpretEffectsLtlConstraintList
  mod m ('InterpretModTag : tags) (op : ops)
</span><a href="Logic.Ltl.html#interpretEffectsLtl"><span class="hs-identifier hs-var hs-var hs-var hs-var">interpretEffectsLtl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
-&gt; InterpretEffectsLtlConstraintList
     mod m ('InterpretModTag : tags) (op : ops)
forall (m :: * -&gt; *) (op :: (* -&gt; *) -&gt; * -&gt; *) mod
       (tags :: [LtlInstanceKind]) (ops :: [(* -&gt; *) -&gt; * -&gt; *]).
(InterpretEffect m op, InterpretMod mod m op) =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
-&gt; InterpretEffectsLtlConstraintList
     mod m ('InterpretModTag : tags) (op : ops)
</span><a href="Logic.Ltl.html#InterpretEffectsLtlFirstorder"><span class="hs-identifier hs-var">InterpretEffectsLtlFirstorder</span></a></span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
forall mod (m :: * -&gt; *) (tags :: [LtlInstanceKind])
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]).
InterpretEffectsLtl mod m tags ops =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="Logic.Ltl.html#interpretEffectsLtl"><span class="hs-identifier hs-var">interpretEffectsLtl</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679188164"><span id="local-6989586621679188165"><span id="local-6989586621679188166"><span id="local-6989586621679188167"><span id="local-6989586621679188168"><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#InterpretEffect"><span class="hs-identifier hs-type">InterpretEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188165"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Logic.Ltl.html#InterpretLtlHigherOrder"><span class="hs-identifier hs-type">InterpretLtlHigherOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188166"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188165"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtl"><span class="hs-identifier hs-type">InterpretEffectsLtl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188166"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188167"><span class="hs-identifier hs-type">tags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188168"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtl"><span class="hs-identifier hs-type">InterpretEffectsLtl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188166"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#InterpretLtlHigherOrderTag"><span class="hs-identifier hs-type">InterpretLtlHigherOrderTag</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188167"><span class="hs-identifier hs-type">tags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188165"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188168"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621679188543"><span class="annot"><span class="annottext">interpretEffectsLtl :: InterpretEffectsLtlConstraintList
  mod m ('InterpretLtlHigherOrderTag : tags) (op : ops)
</span><a href="Logic.Ltl.html#interpretEffectsLtl"><span class="hs-identifier hs-var hs-var hs-var hs-var">interpretEffectsLtl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
-&gt; InterpretEffectsLtlConstraintList
     mod m ('InterpretLtlHigherOrderTag : tags) (op : ops)
forall (m :: * -&gt; *) (op :: (* -&gt; *) -&gt; * -&gt; *) mod
       (tags :: [LtlInstanceKind]) (ops :: [(* -&gt; *) -&gt; * -&gt; *]).
(InterpretEffect m op, InterpretLtlHigherOrder mod m op) =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
-&gt; InterpretEffectsLtlConstraintList
     mod m ('InterpretLtlHigherOrderTag : tags) (op : ops)
</span><a href="Logic.Ltl.html#InterpretEffectsLtlHigherorder"><span class="hs-identifier hs-var">InterpretEffectsLtlHigherorder</span></a></span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
forall mod (m :: * -&gt; *) (tags :: [LtlInstanceKind])
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]).
InterpretEffectsLtl mod m tags ops =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="Logic.Ltl.html#interpretEffectsLtl"><span class="hs-identifier hs-var">interpretEffectsLtl</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679188177"><span id="local-6989586621679188178"><span id="local-6989586621679188179"><span id="local-6989586621679188180"><span id="local-6989586621679188181"><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#InterpretEffectStateful"><span class="hs-identifier hs-type">InterpretEffectStateful</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188177"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188178"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188179"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtl"><span class="hs-identifier hs-type">InterpretEffectsLtl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188177"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188178"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188180"><span class="hs-identifier hs-type">tags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188181"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtl"><span class="hs-identifier hs-type">InterpretEffectsLtl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188177"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188178"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectStatefulTag"><span class="hs-identifier hs-type">InterpretEffectStatefulTag</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188180"><span class="hs-identifier hs-type">tags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188179"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188181"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621679188550"><span class="annot"><span class="annottext">interpretEffectsLtl :: InterpretEffectsLtlConstraintList
  mod m ('InterpretEffectStatefulTag : tags) (op : ops)
</span><a href="Logic.Ltl.html#interpretEffectsLtl"><span class="hs-identifier hs-var hs-var hs-var hs-var">interpretEffectsLtl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
-&gt; InterpretEffectsLtlConstraintList
     mod m ('InterpretEffectStatefulTag : tags) (op : ops)
forall mod (m :: * -&gt; *) (op :: (* -&gt; *) -&gt; * -&gt; *)
       (tags :: [LtlInstanceKind]) (ops :: [(* -&gt; *) -&gt; * -&gt; *]).
InterpretEffectStateful (Const [Ltl mod]) m op =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
-&gt; InterpretEffectsLtlConstraintList
     mod m ('InterpretEffectStatefulTag : tags) (op : ops)
</span><a href="Logic.Ltl.html#InterpretEffectsLtlEffectStateful"><span class="hs-identifier hs-var">InterpretEffectsLtlEffectStateful</span></a></span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
forall mod (m :: * -&gt; *) (tags :: [LtlInstanceKind])
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]).
InterpretEffectsLtl mod m tags ops =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="Logic.Ltl.html#interpretEffectsLtl"><span class="hs-identifier hs-var">interpretEffectsLtl</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | Interpret an 'LtlAST' into a suitable domain.</span><span>
</span><span id="line-287"></span><span class="hs-comment">--</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- Each effect @op@ in the list @ops@ must have one of the following instances:</span><span>
</span><span id="line-289"></span><span class="hs-comment">--</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- - @InterpretLtl mod m op@</span><span>
</span><span id="line-291"></span><span class="hs-comment">--</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- - @InterpretLtlHigherOrder mod m op@</span><span>
</span><span id="line-293"></span><span class="hs-comment">--</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- - @InterpretEffectStateful (Const [Ltl mod]) m op@</span><span>
</span><span id="line-295"></span><span class="hs-comment">--</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- Which instance is expected is declared through the @tags@. Since this type</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- variable is ambiguous, you will have to type-apply this function to a list</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- @tags :: ['LtlInstanceKind']@, which declare, in order, what instance you</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- want to use for the operations in @ops@.</span><span>
</span><span id="line-300"></span><span class="annot"><a href="Logic.Ltl.html#interpretLtlAST"><span class="hs-identifier hs-type">interpretLtlAST</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679188186"><span class="annot"><a href="#local-6989586621679188186"><span class="hs-identifier hs-type">tags</span></a></span></span><span> </span><span id="local-6989586621679188184"><span class="annot"><a href="#local-6989586621679188184"><span class="hs-identifier hs-type">mod</span></a></span></span><span> </span><span id="local-6989586621679188185"><span class="annot"><a href="#local-6989586621679188185"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679188187"><span class="annot"><a href="#local-6989586621679188187"><span class="hs-identifier hs-type">ops</span></a></span></span><span> </span><span id="local-6989586621679188188"><span class="annot"><a href="#local-6989586621679188188"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679188184"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPlus</span></span><span> </span><span class="annot"><a href="#local-6989586621679188185"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtl"><span class="hs-identifier hs-type">InterpretEffectsLtl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188184"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188185"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188186"><span class="hs-identifier hs-type">tags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188187"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><a href="Logic.Ltl.html#LtlAST"><span class="hs-identifier hs-type">LtlAST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188184"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188187"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188188"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-304"></span><span>  </span><span class="annot"><a href="#local-6989586621679188185"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188188"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-305"></span><span id="interpretLtlAST"><span class="annot"><span class="annottext">interpretLtlAST :: forall (tags :: [LtlInstanceKind]) mod (m :: * -&gt; *)
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(Semigroup mod, MonadPlus m, InterpretEffectsLtl mod m tags ops) =&gt;
LtlAST mod ops a -&gt; m a
</span><a href="Logic.Ltl.html#interpretLtlAST"><span class="hs-identifier hs-var hs-var">interpretLtlAST</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (tags :: [LtlInstanceKind]) mod (m :: * -&gt; *)
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(Semigroup mod, MonadPlus m, InterpretEffectsLtl mod m tags ops) =&gt;
[Ltl mod] -&gt; LtlAST mod ops a -&gt; m a
</span><a href="Logic.Ltl.html#interpretLtlASTWithInitialFormulas"><span class="hs-identifier hs-var">interpretLtlASTWithInitialFormulas</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679188186"><span class="hs-identifier hs-type">tags</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">-- | Like 'interpretLtlAST', just with an initial list of 'Ltl' formulas that</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- will be evaluated throughout the interpretation, even when there are no</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- 'modifyLtl's. Prunes all branches that end with incompletely applied 'Ltl'</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- formulas.</span><span>
</span><span id="line-311"></span><span class="hs-comment">--</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- You'll also have to type-apply this to a list of 'LtlInstanceKind's, as described ad</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- 'interpretLtlAST'.</span><span>
</span><span id="line-314"></span><span class="hs-comment">--</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- internal note: This function is the same as 'interpretASTStateful', just for</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- an 'InterpretEffectsLtl' constraint instead of 'InterpretEffectsStateful'.</span><span>
</span><span id="line-317"></span><span class="annot"><a href="Logic.Ltl.html#interpretLtlASTWithInitialFormulas"><span class="hs-identifier hs-type">interpretLtlASTWithInitialFormulas</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679188196"><span class="annot"><a href="#local-6989586621679188196"><span class="hs-identifier hs-type">tags</span></a></span></span><span> </span><span id="local-6989586621679188194"><span class="annot"><a href="#local-6989586621679188194"><span class="hs-identifier hs-type">mod</span></a></span></span><span> </span><span id="local-6989586621679188195"><span class="annot"><a href="#local-6989586621679188195"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679188197"><span class="annot"><a href="#local-6989586621679188197"><span class="hs-identifier hs-type">ops</span></a></span></span><span> </span><span id="local-6989586621679188198"><span class="annot"><a href="#local-6989586621679188198"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679188194"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPlus</span></span><span> </span><span class="annot"><a href="#local-6989586621679188195"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtl"><span class="hs-identifier hs-type">InterpretEffectsLtl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188194"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188195"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188196"><span class="hs-identifier hs-type">tags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188197"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188194"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><a href="Logic.Ltl.html#LtlAST"><span class="hs-identifier hs-type">LtlAST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188194"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188197"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188198"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><a href="#local-6989586621679188195"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188198"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-323"></span><span id="interpretLtlASTWithInitialFormulas"><span class="annot"><span class="annottext">interpretLtlASTWithInitialFormulas :: forall (tags :: [LtlInstanceKind]) mod (m :: * -&gt; *)
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(Semigroup mod, MonadPlus m, InterpretEffectsLtl mod m tags ops) =&gt;
[Ltl mod] -&gt; LtlAST mod ops a -&gt; m a
</span><a href="Logic.Ltl.html#interpretLtlASTWithInitialFormulas"><span class="hs-identifier hs-var hs-var">interpretLtlASTWithInitialFormulas</span></a></span></span><span> </span><span id="local-6989586621679188581"><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188581"><span class="hs-identifier hs-var">ltls</span></a></span></span><span> </span><span id="local-6989586621679188582"><span class="annot"><span class="annottext">LtlAST mod ops a
</span><a href="#local-6989586621679188582"><span class="hs-identifier hs-var">acts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679188583"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188583"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188584"><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188584"><span class="hs-identifier hs-var">finals</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Const [Ltl mod] Any -&gt; [Ltl mod])
-&gt; (a, Const [Ltl mod] Any) -&gt; (a, [Ltl mod])
forall b c d. (b -&gt; c) -&gt; (d, b) -&gt; (d, c)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] Any -&gt; [Ltl mod]
forall {k} a (b :: k). Const a b -&gt; a
</span><span class="hs-identifier hs-var">getConst</span></span><span> </span><span class="annot"><span class="annottext">((a, Const [Ltl mod] Any) -&gt; (a, [Ltl mod]))
-&gt; m (a, Const [Ltl mod] Any) -&gt; m (a, [Ltl mod])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList
  mod m ('InterpretEffectStatefulTag : tags) (LtlEffect mod : ops)
-&gt; Const [Ltl mod] Any
-&gt; LtlAST mod ops a
-&gt; m (a, Const [Ltl mod] Any)
forall mod (m :: * -&gt; *) (tags :: [LtlInstanceKind])
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(Semigroup mod, MonadPlus m) =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
-&gt; Const [Ltl mod] x -&gt; AST ops a -&gt; m (a, Const [Ltl mod] x)
</span><a href="Logic.Ltl.html#interpretASTLtlInternal"><span class="hs-identifier hs-var">interpretASTLtlInternal</span></a></span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList
  mod m ('InterpretEffectStatefulTag : tags) (LtlEffect mod : ops)
</span><a href="#local-6989586621679188588"><span class="hs-identifier hs-var">constraintList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ltl mod] -&gt; Const [Ltl mod] Any
forall {k} a (b :: k). a -&gt; Const a b
</span><span class="hs-identifier hs-var">Const</span></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188581"><span class="hs-identifier hs-var">ltls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LtlAST mod ops a
</span><a href="#local-6989586621679188582"><span class="hs-identifier hs-var">acts</span></a></span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Ltl mod -&gt; Bool) -&gt; [Ltl mod] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Ltl mod -&gt; Bool
forall a. Ltl a -&gt; Bool
</span><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var">finished</span></a></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188584"><span class="hs-identifier hs-var">finals</span></a></span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188583"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">m a
forall a. m a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621679188588"><span class="annot"><span class="annottext">constraintList :: InterpretEffectsLtlConstraintList
  mod m ('InterpretEffectStatefulTag : tags) (LtlEffect mod : ops)
</span><a href="#local-6989586621679188588"><span class="hs-identifier hs-var hs-var">constraintList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall mod (m :: * -&gt; *) (tags :: [LtlInstanceKind])
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]).
InterpretEffectsLtl mod m tags ops =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="Logic.Ltl.html#interpretEffectsLtl"><span class="hs-identifier hs-var">interpretEffectsLtl</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679188194"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679188195"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectStatefulTag"><span class="hs-identifier hs-type">InterpretEffectStatefulTag</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679188196"><span class="hs-identifier hs-type">tags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-comment">-- | Internal: The function that recursively interprets the 'AST' in</span><span>
</span><span id="line-332"></span><span class="hs-comment">-- 'interpretLtlASTWithInitialFormulas'.</span><span>
</span><span id="line-333"></span><span id="local-6989586621679188215"><span id="local-6989586621679188216"><span id="local-6989586621679188217"><span id="local-6989586621679188218"><span id="local-6989586621679188219"><span id="local-6989586621679188220"><span class="annot"><a href="Logic.Ltl.html#interpretASTLtlInternal"><span class="hs-identifier hs-type">interpretASTLtlInternal</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679188215"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPlus</span></span><span> </span><span class="annot"><a href="#local-6989586621679188216"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-335"></span><span>  </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlConstraintList"><span class="hs-identifier hs-type">InterpretEffectsLtlConstraintList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188215"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188216"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188217"><span class="hs-identifier hs-type">tags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188218"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-336"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188215"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188219"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-337"></span><span>  </span><span class="annot"><a href="Effect.Internal.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188218"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188220"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-338"></span><span>  </span><span class="annot"><a href="#local-6989586621679188216"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188220"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188215"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188219"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-339"></span><span id="interpretASTLtlInternal"><span class="annot"><span class="annottext">interpretASTLtlInternal :: forall mod (m :: * -&gt; *) (tags :: [LtlInstanceKind])
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(Semigroup mod, MonadPlus m) =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
-&gt; Const [Ltl mod] x -&gt; AST ops a -&gt; m (a, Const [Ltl mod] x)
</span><a href="Logic.Ltl.html#interpretASTLtlInternal"><span class="hs-identifier hs-var hs-var">interpretASTLtlInternal</span></a></span></span><span> </span><span id="local-6989586621679188595"><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="#local-6989586621679188595"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679188596"><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188596"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-340"></span><span>  </span><span class="annot"><span class="annottext">(forall b.
 Const [Ltl mod] x
 -&gt; Fixpoint (JoinedEffects ops) Freer b
 -&gt; m (b, Const [Ltl mod] x))
-&gt; Const [Ltl mod] x
-&gt; Freer (Fixpoint (JoinedEffects ops) Freer) a
-&gt; m (a, Const [Ltl mod] x)
forall a.
(forall b.
 Const [Ltl mod] x
 -&gt; Fixpoint (JoinedEffects ops) Freer b
 -&gt; m (b, Const [Ltl mod] x))
-&gt; Const [Ltl mod] x
-&gt; Freer (Fixpoint (JoinedEffects ops) Freer) a
-&gt; m (a, Const [Ltl mod] x)
forall x (f :: (* -&gt; *) -&gt; * -&gt; *) (g :: (* -&gt; *) -&gt; * -&gt; *)
       (m :: * -&gt; *) a.
InterpretOneLayerState x f g m =&gt;
(forall b. x -&gt; Fixpoint g f b -&gt; m (b, x))
-&gt; x -&gt; f (Fixpoint g f) a -&gt; m (a, x)
</span><a href="Effect.Internal.html#interpretOneLayerState"><span class="hs-identifier hs-var">interpretOneLayerState</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679188600"><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188600"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679188601"><span class="annot"><span class="annottext">Fixpoint (JoinedEffects ops) Freer b
</span><a href="#local-6989586621679188601"><span class="hs-identifier hs-var">acts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-342"></span><span>        </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
-&gt; (forall b y.
    Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x
-&gt; JoinedEffects ops (AST ops) b
-&gt; m (b, Const [Ltl mod] x)
forall mod (m :: * -&gt; *) (tags :: [LtlInstanceKind])
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) (allOps :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(Semigroup mod, MonadPlus m) =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
-&gt; (forall b y.
    Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x
-&gt; JoinedEffects ops (AST allOps) a
-&gt; m (a, Const [Ltl mod] x)
</span><a href="Logic.Ltl.html#interpretJoinedEffectsLtl"><span class="hs-identifier hs-var">interpretJoinedEffectsLtl</span></a></span><span>
</span><span id="line-343"></span><span>          </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="#local-6989586621679188595"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-344"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
-&gt; Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y)
forall mod (m :: * -&gt; *) (tags :: [LtlInstanceKind])
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(Semigroup mod, MonadPlus m) =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
-&gt; Const [Ltl mod] x -&gt; AST ops a -&gt; m (a, Const [Ltl mod] x)
</span><a href="Logic.Ltl.html#interpretASTLtlInternal"><span class="hs-identifier hs-var">interpretASTLtlInternal</span></a></span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="#local-6989586621679188595"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>          </span><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188600"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-346"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fixpoint (JoinedEffects ops) Freer b
-&gt; JoinedEffects ops (AST ops) b
forall (f :: (* -&gt; *) -&gt; * -&gt; *) (g :: (* -&gt; *) -&gt; * -&gt; *) a.
Fixpoint f g a -&gt; f (Fixpoint g f) a
</span><a href="Effect.Internal.html#unFixpoint"><span class="hs-identifier hs-var">unFixpoint</span></a></span><span> </span><span class="annot"><span class="annottext">Fixpoint (JoinedEffects ops) Freer b
</span><a href="#local-6989586621679188601"><span class="hs-identifier hs-var">acts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188596"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><span class="annottext">(Freer (Fixpoint (JoinedEffects ops) Freer) a
 -&gt; m (a, Const [Ltl mod] x))
-&gt; (AST ops a -&gt; Freer (Fixpoint (JoinedEffects ops) Freer) a)
-&gt; AST ops a
-&gt; m (a, Const [Ltl mod] x)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AST ops a -&gt; Freer (Fixpoint (JoinedEffects ops) Freer) a
forall (f :: (* -&gt; *) -&gt; * -&gt; *) (g :: (* -&gt; *) -&gt; * -&gt; *) a.
Fixpoint f g a -&gt; f (Fixpoint g f) a
</span><a href="Effect.Internal.html#unFixpoint"><span class="hs-identifier hs-var">unFixpoint</span></a></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">-- | Internal: For 'interpretLtlASTWithInitialFormulas', we need a function</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- that takes a 'JoinedEffects', where each effect has one of the three relevant</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- instances, and returns the effect's interpretation.</span><span>
</span><span id="line-354"></span><span class="hs-comment">--</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- This function is called in a mutually recursive fashion with 'interpretASTLtlInternal'.</span><span>
</span><span id="line-356"></span><span id="local-6989586621679188245"><span id="local-6989586621679188246"><span id="local-6989586621679188247"><span id="local-6989586621679188248"><span id="local-6989586621679188249"><span id="local-6989586621679188250"><span id="local-6989586621679188251"><span class="annot"><a href="Logic.Ltl.html#interpretJoinedEffectsLtl"><span class="hs-identifier hs-type">interpretJoinedEffectsLtl</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679188245"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPlus</span></span><span> </span><span class="annot"><a href="#local-6989586621679188246"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-358"></span><span>  </span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlConstraintList"><span class="hs-identifier hs-type">InterpretEffectsLtlConstraintList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188245"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188246"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188247"><span class="hs-identifier hs-type">tags</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188248"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679188244"><span class="annot"><a href="#local-6989586621679188244"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679188243"><span class="annot"><a href="#local-6989586621679188243"><span class="hs-identifier hs-type">y</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188245"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188243"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effect.Internal.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188249"><span class="hs-identifier hs-type">allOps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188244"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188246"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188244"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188245"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188243"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-360"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188245"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188250"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><a href="Effect.Internal.html#JoinedEffects"><span class="hs-identifier hs-type">JoinedEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188248"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188249"><span class="hs-identifier hs-type">allOps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188251"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><a href="#local-6989586621679188246"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188251"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188245"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188250"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-363"></span><span id="interpretJoinedEffectsLtl"><span class="annot"><span class="annottext">interpretJoinedEffectsLtl :: forall mod (m :: * -&gt; *) (tags :: [LtlInstanceKind])
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) (allOps :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(Semigroup mod, MonadPlus m) =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
-&gt; (forall b y.
    Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x
-&gt; JoinedEffects ops (AST allOps) a
-&gt; m (a, Const [Ltl mod] x)
</span><a href="Logic.Ltl.html#interpretJoinedEffectsLtl"><span class="hs-identifier hs-var hs-var">interpretJoinedEffectsLtl</span></a></span></span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="Logic.Ltl.html#InterpretEffectsLtlNil"><span class="hs-identifier hs-var">InterpretEffectsLtlNil</span></a></span><span> </span><span class="annot"><span class="annottext">forall b y.
Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679188609"><span class="annot"><span class="annottext">JoinedEffects ops (AST allOps) a
</span><a href="#local-6989586621679188609"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">JoinedEffects ops (AST allOps) a
</span><a href="#local-6989586621679188609"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-364"></span><span class="annot"><a href="Logic.Ltl.html#interpretJoinedEffectsLtl"><span class="hs-identifier hs-var">interpretJoinedEffectsLtl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlFirstorder"><span class="hs-identifier hs-type">InterpretEffectsLtlFirstorder</span></a></span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188614"><span class="annot"><span class="annottext">forall b y.
Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188614"><span class="hs-identifier hs-var">evalAST</span></a></span></span><span> </span><span id="local-6989586621679188615"><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188615"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#JoinedEffectsHere"><span class="hs-identifier hs-type">JoinedEffectsHere</span></a></span><span> </span><span id="local-6989586621679188625"><span class="annot"><span class="annottext">op (AST allOps) a
</span><a href="#local-6989586621679188625"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-365"></span><span>  </span><span class="annot"><span class="annottext">(forall b y.
 Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x
-&gt; op (AST allOps) a
-&gt; m (a, Const [Ltl mod] x)
forall mod (m :: * -&gt; *) (op :: (* -&gt; *) -&gt; * -&gt; *)
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(Semigroup mod, MonadPlus m, InterpretEffect m op,
 InterpretMod mod m op) =&gt;
(forall b y.
 Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x -&gt; op (AST ops) a -&gt; m (a, Const [Ltl mod] x)
</span><a href="Logic.Ltl.html#interpretEffectStatefulFromLtl"><span class="hs-identifier hs-var">interpretEffectStatefulFromLtl</span></a></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
forall b y.
Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188614"><span class="hs-identifier hs-var">evalAST</span></a></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">op (AST allOps) a
</span><a href="#local-6989586621679188625"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-366"></span><span class="annot"><a href="Logic.Ltl.html#interpretJoinedEffectsLtl"><span class="hs-identifier hs-var">interpretJoinedEffectsLtl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlFirstorder"><span class="hs-identifier hs-type">InterpretEffectsLtlFirstorder</span></a></span><span> </span><span id="local-6989586621679188631"><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="#local-6989586621679188631"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188632"><span class="annot"><span class="annottext">forall b y.
Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188632"><span class="hs-identifier hs-var">evalAST</span></a></span></span><span> </span><span id="local-6989586621679188633"><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188633"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#JoinedEffectsThere"><span class="hs-identifier hs-type">JoinedEffectsThere</span></a></span><span> </span><span id="local-6989586621679188641"><span class="annot"><span class="annottext">JoinedEffects ops1 (AST allOps) a
</span><a href="#local-6989586621679188641"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
-&gt; (forall b y.
    Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x
-&gt; JoinedEffects ops (AST allOps) a
-&gt; m (a, Const [Ltl mod] x)
forall mod (m :: * -&gt; *) (tags :: [LtlInstanceKind])
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) (allOps :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(Semigroup mod, MonadPlus m) =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
-&gt; (forall b y.
    Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x
-&gt; JoinedEffects ops (AST allOps) a
-&gt; m (a, Const [Ltl mod] x)
</span><a href="Logic.Ltl.html#interpretJoinedEffectsLtl"><span class="hs-identifier hs-var">interpretJoinedEffectsLtl</span></a></span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="#local-6989586621679188631"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
forall b y.
Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188632"><span class="hs-identifier hs-var">evalAST</span></a></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188633"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">JoinedEffects ops (AST allOps) a
JoinedEffects ops1 (AST allOps) a
</span><a href="#local-6989586621679188641"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-368"></span><span class="annot"><a href="Logic.Ltl.html#interpretJoinedEffectsLtl"><span class="hs-identifier hs-var">interpretJoinedEffectsLtl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlHigherorder"><span class="hs-identifier hs-type">InterpretEffectsLtlHigherorder</span></a></span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188646"><span class="annot"><span class="annottext">forall b y.
Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188646"><span class="hs-identifier hs-var">evalAST</span></a></span></span><span> </span><span id="local-6989586621679188647"><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188647"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#JoinedEffectsHere"><span class="hs-identifier hs-type">JoinedEffectsHere</span></a></span><span> </span><span id="local-6989586621679188656"><span class="annot"><span class="annottext">op (AST allOps) a
</span><a href="#local-6989586621679188656"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-369"></span><span>  </span><span class="annot"><span class="annottext">(forall b y.
 Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x
-&gt; op (AST allOps) a
-&gt; m (a, Const [Ltl mod] x)
forall mod (m :: * -&gt; *) (op :: (* -&gt; *) -&gt; * -&gt; *)
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(Semigroup mod, MonadPlus m, InterpretEffect m op,
 InterpretLtlHigherOrder mod m op) =&gt;
(forall b y.
 Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x -&gt; op (AST ops) a -&gt; m (a, Const [Ltl mod] x)
</span><a href="Logic.Ltl.html#interpretEffectStatefulFromLtlHigherOrder"><span class="hs-identifier hs-var">interpretEffectStatefulFromLtlHigherOrder</span></a></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
forall b y.
Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188646"><span class="hs-identifier hs-var">evalAST</span></a></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188647"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">op (AST allOps) a
</span><a href="#local-6989586621679188656"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-370"></span><span class="annot"><a href="Logic.Ltl.html#interpretJoinedEffectsLtl"><span class="hs-identifier hs-var">interpretJoinedEffectsLtl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlHigherorder"><span class="hs-identifier hs-type">InterpretEffectsLtlHigherorder</span></a></span><span> </span><span id="local-6989586621679188662"><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="#local-6989586621679188662"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188663"><span class="annot"><span class="annottext">forall b y.
Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188663"><span class="hs-identifier hs-var">evalAST</span></a></span></span><span> </span><span id="local-6989586621679188664"><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188664"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#JoinedEffectsThere"><span class="hs-identifier hs-type">JoinedEffectsThere</span></a></span><span> </span><span id="local-6989586621679188671"><span class="annot"><span class="annottext">JoinedEffects ops1 (AST allOps) a
</span><a href="#local-6989586621679188671"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-371"></span><span>  </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
-&gt; (forall b y.
    Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x
-&gt; JoinedEffects ops (AST allOps) a
-&gt; m (a, Const [Ltl mod] x)
forall mod (m :: * -&gt; *) (tags :: [LtlInstanceKind])
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) (allOps :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(Semigroup mod, MonadPlus m) =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
-&gt; (forall b y.
    Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x
-&gt; JoinedEffects ops (AST allOps) a
-&gt; m (a, Const [Ltl mod] x)
</span><a href="Logic.Ltl.html#interpretJoinedEffectsLtl"><span class="hs-identifier hs-var">interpretJoinedEffectsLtl</span></a></span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="#local-6989586621679188662"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
forall b y.
Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188663"><span class="hs-identifier hs-var">evalAST</span></a></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188664"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">JoinedEffects ops (AST allOps) a
JoinedEffects ops1 (AST allOps) a
</span><a href="#local-6989586621679188671"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-372"></span><span class="annot"><a href="Logic.Ltl.html#interpretJoinedEffectsLtl"><span class="hs-identifier hs-var">interpretJoinedEffectsLtl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlEffectStateful"><span class="hs-identifier hs-type">InterpretEffectsLtlEffectStateful</span></a></span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188675"><span class="annot"><span class="annottext">forall b y.
Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188675"><span class="hs-identifier hs-var">evalAST</span></a></span></span><span> </span><span id="local-6989586621679188676"><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188676"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#JoinedEffectsHere"><span class="hs-identifier hs-type">JoinedEffectsHere</span></a></span><span> </span><span id="local-6989586621679188682"><span class="annot"><span class="annottext">op (AST allOps) a
</span><a href="#local-6989586621679188682"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-373"></span><span>  </span><span class="annot"><span class="annottext">(forall b y.
 Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x
-&gt; op (AST allOps) a
-&gt; m (a, Const [Ltl mod] x)
forall (ops :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(forall b y.
 Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x -&gt; op (AST ops) a -&gt; m (a, Const [Ltl mod] x)
forall (t :: * -&gt; *) (m :: * -&gt; *) (op :: (* -&gt; *) -&gt; * -&gt; *)
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
InterpretEffectStateful t m op =&gt;
(forall b y. t y -&gt; AST ops b -&gt; m (b, t y))
-&gt; t x -&gt; op (AST ops) a -&gt; m (a, t x)
</span><a href="Effect.Internal.html#interpretEffectStateful"><span class="hs-identifier hs-var">interpretEffectStateful</span></a></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
forall b y.
Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188675"><span class="hs-identifier hs-var">evalAST</span></a></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188676"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">op (AST allOps) a
</span><a href="#local-6989586621679188682"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-374"></span><span class="annot"><a href="Logic.Ltl.html#interpretJoinedEffectsLtl"><span class="hs-identifier hs-var">interpretJoinedEffectsLtl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#InterpretEffectsLtlEffectStateful"><span class="hs-identifier hs-type">InterpretEffectsLtlEffectStateful</span></a></span><span> </span><span id="local-6989586621679188686"><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="#local-6989586621679188686"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188687"><span class="annot"><span class="annottext">forall b y.
Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188687"><span class="hs-identifier hs-var">evalAST</span></a></span></span><span> </span><span id="local-6989586621679188688"><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188688"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#JoinedEffectsThere"><span class="hs-identifier hs-type">JoinedEffectsThere</span></a></span><span> </span><span id="local-6989586621679188695"><span class="annot"><span class="annottext">JoinedEffects ops1 (AST allOps) a
</span><a href="#local-6989586621679188695"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
-&gt; (forall b y.
    Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x
-&gt; JoinedEffects ops (AST allOps) a
-&gt; m (a, Const [Ltl mod] x)
forall mod (m :: * -&gt; *) (tags :: [LtlInstanceKind])
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) (allOps :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(Semigroup mod, MonadPlus m) =&gt;
InterpretEffectsLtlConstraintList mod m tags ops
-&gt; (forall b y.
    Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x
-&gt; JoinedEffects ops (AST allOps) a
-&gt; m (a, Const [Ltl mod] x)
</span><a href="Logic.Ltl.html#interpretJoinedEffectsLtl"><span class="hs-identifier hs-var">interpretJoinedEffectsLtl</span></a></span><span> </span><span class="annot"><span class="annottext">InterpretEffectsLtlConstraintList mod m tags ops
</span><a href="#local-6989586621679188686"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
forall b y.
Const [Ltl mod] y -&gt; AST allOps b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188687"><span class="hs-identifier hs-var">evalAST</span></a></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] x
</span><a href="#local-6989586621679188688"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">JoinedEffects ops (AST allOps) a
JoinedEffects ops1 (AST allOps) a
</span><a href="#local-6989586621679188695"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="hs-comment">-- | Internal: For 'interpretJoinedEffectsLtl', we'll need a function that</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- behaves like 'interpretEffectStateful', in the setting where we only have an</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- 'InterpretMod' instance. This is that function.</span><span>
</span><span id="line-380"></span><span id="local-6989586621679188269"><span id="local-6989586621679188270"><span id="local-6989586621679188271"><span id="local-6989586621679188273"><span id="local-6989586621679188275"><span id="local-6989586621679188276"><span class="annot"><a href="Logic.Ltl.html#interpretEffectStatefulFromLtl"><span class="hs-identifier hs-type">interpretEffectStatefulFromLtl</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679188269"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-382"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadPlus</span></span><span> </span><span class="annot"><a href="#local-6989586621679188270"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><a href="Effect.Internal.html#InterpretEffect"><span class="hs-identifier hs-type">InterpretEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188270"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188271"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><a href="Logic.SingleStep.html#InterpretMod"><span class="hs-identifier hs-type">InterpretMod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188269"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188270"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188271"><span class="hs-identifier hs-type">op</span></a></span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679188274"><span class="annot"><a href="#local-6989586621679188274"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679188272"><span class="annot"><a href="#local-6989586621679188272"><span class="hs-identifier hs-type">y</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188269"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188272"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effect.Internal.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188273"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188274"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188270"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188274"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188269"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188272"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-387"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188269"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188275"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-388"></span><span>  </span><span class="annot"><a href="#local-6989586621679188271"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188273"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188276"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-389"></span><span>  </span><span class="annot"><a href="#local-6989586621679188270"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188276"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188269"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188275"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-390"></span><span id="interpretEffectStatefulFromLtl"><span class="annot"><span class="annottext">interpretEffectStatefulFromLtl :: forall mod (m :: * -&gt; *) (op :: (* -&gt; *) -&gt; * -&gt; *)
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(Semigroup mod, MonadPlus m, InterpretEffect m op,
 InterpretMod mod m op) =&gt;
(forall b y.
 Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x -&gt; op (AST ops) a -&gt; m (a, Const [Ltl mod] x)
</span><a href="Logic.Ltl.html#interpretEffectStatefulFromLtl"><span class="hs-identifier hs-var hs-var">interpretEffectStatefulFromLtl</span></a></span></span><span> </span><span id="local-6989586621679188713"><span class="annot"><span class="annottext">forall b y.
Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188713"><span class="hs-identifier hs-var">evalActs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span id="local-6989586621679188714"><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188714"><span class="hs-identifier hs-var">ltls</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188715"><span class="annot"><span class="annottext">op (AST ops) a
</span><a href="#local-6989586621679188715"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">op (AST ops) a -&gt; ModInterp mod m a
forall (dummy :: [(* -&gt; *) -&gt; * -&gt; *]) a.
op (AST dummy) a -&gt; ModInterp mod m a
forall mod (m :: * -&gt; *) (op :: (* -&gt; *) -&gt; * -&gt; *)
       (dummy :: [(* -&gt; *) -&gt; * -&gt; *]) a.
InterpretMod mod m op =&gt;
op (AST dummy) a -&gt; ModInterp mod m a
</span><a href="Logic.SingleStep.html#interpretMod"><span class="hs-identifier hs-var">interpretMod</span></a></span><span> </span><span class="annot"><span class="annottext">op (AST ops) a
</span><a href="#local-6989586621679188715"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-392"></span><span>    </span><span class="annot"><span class="annottext">ModInterp mod m a
</span><a href="Logic.SingleStep.html#Invisible"><span class="hs-identifier hs-var">Invisible</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ltl mod] -&gt; op (AST ops) a -&gt; m (a, Const [Ltl mod] x)
</span><a href="#local-6989586621679188718"><span class="hs-identifier hs-var">interpretUnmodified</span></a></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188714"><span class="hs-identifier hs-var">ltls</span></a></span><span> </span><span class="annot"><span class="annottext">op (AST ops) a
</span><a href="#local-6989586621679188715"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><a href="Logic.SingleStep.html#Visible"><span class="hs-identifier hs-type">Visible</span></a></span><span> </span><span id="local-6989586621679188720"><span class="annot"><span class="annottext">mod -&gt; m (Maybe a)
</span><a href="#local-6989586621679188720"><span class="hs-identifier hs-var">attempt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-394"></span><span>      </span><span class="annot"><span class="annottext">[m (a, Const [Ltl mod] x)] -&gt; m (a, Const [Ltl mod] x)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span> </span><span class="annot"><span class="annottext">([m (a, Const [Ltl mod] x)] -&gt; m (a, Const [Ltl mod] x))
-&gt; [m (a, Const [Ltl mod] x)] -&gt; m (a, Const [Ltl mod] x)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-395"></span><span>        </span><span class="annot"><span class="annottext">((Maybe mod, [Ltl mod]) -&gt; m (a, Const [Ltl mod] x))
-&gt; [(Maybe mod, [Ltl mod])] -&gt; [m (a, Const [Ltl mod] x)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-396"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679188722"><span class="annot"><span class="annottext">Maybe mod
</span><a href="#local-6989586621679188722"><span class="hs-identifier hs-var">now</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188723"><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188723"><span class="hs-identifier hs-var">later</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-397"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe mod
</span><a href="#local-6989586621679188722"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-398"></span><span>                </span><span class="annot"><span class="annottext">Maybe mod
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ltl mod] -&gt; op (AST ops) a -&gt; m (a, Const [Ltl mod] x)
</span><a href="#local-6989586621679188718"><span class="hs-identifier hs-var">interpretUnmodified</span></a></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188723"><span class="hs-identifier hs-var">later</span></a></span><span> </span><span class="annot"><span class="annottext">op (AST ops) a
</span><a href="#local-6989586621679188715"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-399"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679188724"><span class="annot"><span class="annottext">mod
</span><a href="#local-6989586621679188724"><span class="hs-identifier hs-var">now'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-400"></span><span>                  </span><span id="local-6989586621679188725"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679188725"><span class="hs-identifier hs-var">mA</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">mod -&gt; m (Maybe a)
</span><a href="#local-6989586621679188720"><span class="hs-identifier hs-var">attempt</span></a></span><span> </span><span class="annot"><span class="annottext">mod
</span><a href="#local-6989586621679188724"><span class="hs-identifier hs-var">now'</span></a></span><span>
</span><span id="line-401"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679188725"><span class="hs-identifier hs-var">mA</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-402"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679188726"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188726"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, Const [Ltl mod] x) -&gt; m (a, Const [Ltl mod] x)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188726"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ltl mod] -&gt; Const [Ltl mod] x
forall {k} a (b :: k). a -&gt; Const a b
</span><span class="hs-identifier hs-var">Const</span></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188723"><span class="hs-identifier hs-var">later</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>                    </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (a, Const [Ltl mod] x)
forall a. m a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-404"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ltl mod] -&gt; [(Maybe mod, [Ltl mod])]
forall a. Semigroup a =&gt; [Ltl a] -&gt; [(Maybe a, [Ltl a])]
</span><a href="Logic.Ltl.html#nowLaterList"><span class="hs-identifier hs-var">nowLaterList</span></a></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188714"><span class="hs-identifier hs-var">ltls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621679188718"><span class="annot"><span class="annottext">interpretUnmodified :: [Ltl mod] -&gt; op (AST ops) a -&gt; m (a, Const [Ltl mod] x)
</span><a href="#local-6989586621679188718"><span class="hs-identifier hs-var hs-var">interpretUnmodified</span></a></span></span><span> </span><span id="local-6989586621679188727"><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188727"><span class="hs-identifier hs-var">later</span></a></span></span><span> </span><span id="local-6989586621679188728"><span class="annot"><span class="annottext">op (AST ops) a
</span><a href="#local-6989586621679188728"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-408"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ltl mod] -&gt; Const [Ltl mod] x
forall {k} a (b :: k). a -&gt; Const a b
</span><span class="hs-identifier hs-var">Const</span></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188727"><span class="hs-identifier hs-var">later</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>        </span><span class="annot"><span class="annottext">(a -&gt; (a, Const [Ltl mod] x)) -&gt; m a -&gt; m (a, Const [Ltl mod] x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(forall b. AST ops b -&gt; m b) -&gt; op (AST ops) a -&gt; m a
forall (ops :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(forall b. AST ops b -&gt; m b) -&gt; op (AST ops) a -&gt; m a
forall (m :: * -&gt; *) (op :: (* -&gt; *) -&gt; * -&gt; *)
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) a.
InterpretEffect m op =&gt;
(forall b. AST ops b -&gt; m b) -&gt; op (AST ops) a -&gt; m a
</span><a href="Effect.Internal.html#interpretEffect"><span class="hs-identifier hs-var">interpretEffect</span></a></span><span>
</span><span id="line-410"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((b, Const [Ltl mod] Any) -&gt; b)
-&gt; m (b, Const [Ltl mod] Any) -&gt; m b
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(b, Const [Ltl mod] Any) -&gt; b
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(m (b, Const [Ltl mod] Any) -&gt; m b)
-&gt; (AST ops b -&gt; m (b, Const [Ltl mod] Any)) -&gt; AST ops b -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] Any -&gt; AST ops b -&gt; m (b, Const [Ltl mod] Any)
forall b y.
Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188713"><span class="hs-identifier hs-var">evalActs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ltl mod] -&gt; Const [Ltl mod] Any
forall {k} a (b :: k). a -&gt; Const a b
</span><span class="hs-identifier hs-var">Const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>          </span><span class="annot"><span class="annottext">op (AST ops) a
</span><a href="#local-6989586621679188728"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="hs-comment">-- | Internal: Like 'interpretEffectStatefulFromLtl', just for the higher-order</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- instance.</span><span>
</span><span id="line-415"></span><span id="local-6989586621679188291"><span id="local-6989586621679188292"><span id="local-6989586621679188293"><span id="local-6989586621679188295"><span id="local-6989586621679188297"><span id="local-6989586621679188298"><span class="annot"><a href="Logic.Ltl.html#interpretEffectStatefulFromLtlHigherOrder"><span class="hs-identifier hs-type">interpretEffectStatefulFromLtlHigherOrder</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-416"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679188291"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-417"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadPlus</span></span><span> </span><span class="annot"><a href="#local-6989586621679188292"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-418"></span><span>    </span><span class="annot"><a href="Effect.Internal.html#InterpretEffect"><span class="hs-identifier hs-type">InterpretEffect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188292"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188293"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-419"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#InterpretLtlHigherOrder"><span class="hs-identifier hs-type">InterpretLtlHigherOrder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188291"><span class="hs-identifier hs-type">mod</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188292"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188293"><span class="hs-identifier hs-type">op</span></a></span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679188296"><span class="annot"><a href="#local-6989586621679188296"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679188294"><span class="annot"><a href="#local-6989586621679188294"><span class="hs-identifier hs-type">y</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188291"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188294"><span class="hs-identifier hs-type">y</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Effect.Internal.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188295"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188296"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188292"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188296"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188291"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188294"><span class="hs-identifier hs-type">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188291"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188297"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-423"></span><span>  </span><span class="annot"><a href="#local-6989586621679188293"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Effect.Internal.html#AST"><span class="hs-identifier hs-type">AST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188295"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188298"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-424"></span><span>  </span><span class="annot"><a href="#local-6989586621679188292"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188298"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188291"><span class="hs-identifier hs-type">mod</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679188297"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-425"></span><span id="interpretEffectStatefulFromLtlHigherOrder"><span class="annot"><span class="annottext">interpretEffectStatefulFromLtlHigherOrder :: forall mod (m :: * -&gt; *) (op :: (* -&gt; *) -&gt; * -&gt; *)
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) x a.
(Semigroup mod, MonadPlus m, InterpretEffect m op,
 InterpretLtlHigherOrder mod m op) =&gt;
(forall b y.
 Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y))
-&gt; Const [Ltl mod] x -&gt; op (AST ops) a -&gt; m (a, Const [Ltl mod] x)
</span><a href="Logic.Ltl.html#interpretEffectStatefulFromLtlHigherOrder"><span class="hs-identifier hs-var hs-var">interpretEffectStatefulFromLtlHigherOrder</span></a></span></span><span> </span><span id="local-6989586621679188752"><span class="annot"><span class="annottext">forall b y.
Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188752"><span class="hs-identifier hs-var">evalActs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span id="local-6989586621679188753"><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188753"><span class="hs-identifier hs-var">ltls</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188754"><span class="annot"><span class="annottext">op (AST ops) a
</span><a href="#local-6989586621679188754"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">op (AST ops) a -&gt; LtlInterpHigherOrder mod m ops a
forall (ops :: [(* -&gt; *) -&gt; * -&gt; *]) a.
op (AST ops) a -&gt; LtlInterpHigherOrder mod m ops a
forall mod (m :: * -&gt; *) (op :: (* -&gt; *) -&gt; * -&gt; *)
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) a.
InterpretLtlHigherOrder mod m op =&gt;
op (AST ops) a -&gt; LtlInterpHigherOrder mod m ops a
</span><a href="Logic.Ltl.html#interpretLtlHigherOrder"><span class="hs-identifier hs-var">interpretLtlHigherOrder</span></a></span><span> </span><span class="annot"><span class="annottext">op (AST ops) a
</span><a href="#local-6989586621679188754"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#Direct"><span class="hs-identifier hs-type">Direct</span></a></span><span> </span><span id="local-6989586621679188755"><span class="annot"><span class="annottext">ModInterp mod m a
</span><a href="#local-6989586621679188755"><span class="hs-identifier hs-var">inner</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ModInterp mod m a
</span><a href="#local-6989586621679188755"><span class="hs-identifier hs-var">inner</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-428"></span><span>      </span><span class="annot"><span class="annottext">ModInterp mod m a
</span><a href="Logic.SingleStep.html#Invisible"><span class="hs-identifier hs-var">Invisible</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ltl mod] -&gt; op (AST ops) a -&gt; m (a, Const [Ltl mod] x)
</span><a href="#local-6989586621679188756"><span class="hs-identifier hs-var">interpretUnmodified</span></a></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188753"><span class="hs-identifier hs-var">ltls</span></a></span><span> </span><span class="annot"><span class="annottext">op (AST ops) a
</span><a href="#local-6989586621679188754"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-429"></span><span>      </span><span class="annot"><a href="Logic.SingleStep.html#Visible"><span class="hs-identifier hs-type">Visible</span></a></span><span> </span><span id="local-6989586621679188757"><span class="annot"><span class="annottext">mod -&gt; m (Maybe a)
</span><a href="#local-6989586621679188757"><span class="hs-identifier hs-var">attempt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-430"></span><span>        </span><span class="annot"><span class="annottext">[m (a, Const [Ltl mod] x)] -&gt; m (a, Const [Ltl mod] x)
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span> </span><span class="annot"><span class="annottext">([m (a, Const [Ltl mod] x)] -&gt; m (a, Const [Ltl mod] x))
-&gt; [m (a, Const [Ltl mod] x)] -&gt; m (a, Const [Ltl mod] x)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-431"></span><span>          </span><span class="annot"><span class="annottext">((Maybe mod, [Ltl mod]) -&gt; m (a, Const [Ltl mod] x))
-&gt; [(Maybe mod, [Ltl mod])] -&gt; [m (a, Const [Ltl mod] x)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-432"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679188758"><span class="annot"><span class="annottext">Maybe mod
</span><a href="#local-6989586621679188758"><span class="hs-identifier hs-var">now</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188759"><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188759"><span class="hs-identifier hs-var">later</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-433"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe mod
</span><a href="#local-6989586621679188758"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-434"></span><span>                  </span><span class="annot"><span class="annottext">Maybe mod
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ltl mod] -&gt; op (AST ops) a -&gt; m (a, Const [Ltl mod] x)
</span><a href="#local-6989586621679188756"><span class="hs-identifier hs-var">interpretUnmodified</span></a></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188759"><span class="hs-identifier hs-var">later</span></a></span><span> </span><span class="annot"><span class="annottext">op (AST ops) a
</span><a href="#local-6989586621679188754"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-435"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679188760"><span class="annot"><span class="annottext">mod
</span><a href="#local-6989586621679188760"><span class="hs-identifier hs-var">now'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-436"></span><span>                    </span><span id="local-6989586621679188761"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679188761"><span class="hs-identifier hs-var">mA</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">mod -&gt; m (Maybe a)
</span><a href="#local-6989586621679188757"><span class="hs-identifier hs-var">attempt</span></a></span><span> </span><span class="annot"><span class="annottext">mod
</span><a href="#local-6989586621679188760"><span class="hs-identifier hs-var">now'</span></a></span><span>
</span><span id="line-437"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679188761"><span class="hs-identifier hs-var">mA</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-438"></span><span>                      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679188762"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188762"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, Const [Ltl mod] x) -&gt; m (a, Const [Ltl mod] x)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188762"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ltl mod] -&gt; Const [Ltl mod] x
forall {k} a (b :: k). a -&gt; Const a b
</span><span class="hs-identifier hs-var">Const</span></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188759"><span class="hs-identifier hs-var">later</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>                      </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (a, Const [Ltl mod] x)
forall a. m a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-440"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ltl mod] -&gt; [(Maybe mod, [Ltl mod])]
forall a. Semigroup a =&gt; [Ltl a] -&gt; [(Maybe a, [Ltl a])]
</span><a href="Logic.Ltl.html#nowLaterList"><span class="hs-identifier hs-var">nowLaterList</span></a></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188753"><span class="hs-identifier hs-var">ltls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>    </span><span class="annot"><a href="Logic.Ltl.html#Nested"><span class="hs-identifier hs-type">Nested</span></a></span><span> </span><span id="local-6989586621679188763"><span class="annot"><span class="annottext">(forall b. [Ltl mod] -&gt; AST ops b -&gt; m (b, [Ltl mod]))
-&gt; [Ltl mod] -&gt; m (Maybe (a, [Ltl mod]))
</span><a href="#local-6989586621679188763"><span class="hs-identifier hs-var">nestFun</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-443"></span><span>      </span><span id="local-6989586621679188764"><span class="annot"><span class="annottext">Maybe (a, [Ltl mod])
</span><a href="#local-6989586621679188764"><span class="hs-identifier hs-var">mA</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(forall b. [Ltl mod] -&gt; AST ops b -&gt; m (b, [Ltl mod]))
-&gt; [Ltl mod] -&gt; m (Maybe (a, [Ltl mod]))
</span><a href="#local-6989586621679188763"><span class="hs-identifier hs-var">nestFun</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679188767"><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188767"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span id="local-6989586621679188768"><span class="annot"><span class="annottext">AST ops b
</span><a href="#local-6989586621679188768"><span class="hs-identifier hs-var">ast</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Const [Ltl mod] Any -&gt; [Ltl mod])
-&gt; (b, Const [Ltl mod] Any) -&gt; (b, [Ltl mod])
forall b c d. (b -&gt; c) -&gt; (d, b) -&gt; (d, c)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] Any -&gt; [Ltl mod]
forall {k} a (b :: k). Const a b -&gt; a
</span><span class="hs-identifier hs-var">getConst</span></span><span> </span><span class="annot"><span class="annottext">((b, Const [Ltl mod] Any) -&gt; (b, [Ltl mod]))
-&gt; m (b, Const [Ltl mod] Any) -&gt; m (b, [Ltl mod])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] Any -&gt; AST ops b -&gt; m (b, Const [Ltl mod] Any)
forall b y.
Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188752"><span class="hs-identifier hs-var">evalActs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ltl mod] -&gt; Const [Ltl mod] Any
forall {k} a (b :: k). a -&gt; Const a b
</span><span class="hs-identifier hs-var">Const</span></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188767"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AST ops b
</span><a href="#local-6989586621679188768"><span class="hs-identifier hs-var">ast</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188753"><span class="hs-identifier hs-var">ltls</span></a></span><span>
</span><span id="line-444"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (a, [Ltl mod])
</span><a href="#local-6989586621679188764"><span class="hs-identifier hs-var">mA</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-445"></span><span>        </span><span class="annot"><span class="annottext">Maybe (a, [Ltl mod])
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (a, Const [Ltl mod] x)
forall a. m a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-446"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188769"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188769"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188770"><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188770"><span class="hs-identifier hs-var">ltls'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, Const [Ltl mod] x) -&gt; m (a, Const [Ltl mod] x)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188769"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ltl mod] -&gt; Const [Ltl mod] x
forall {k} a (b :: k). a -&gt; Const a b
</span><span class="hs-identifier hs-var">Const</span></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188770"><span class="hs-identifier hs-var">ltls'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>    </span><span id="local-6989586621679188756"><span class="annot"><span class="annottext">interpretUnmodified :: [Ltl mod] -&gt; op (AST ops) a -&gt; m (a, Const [Ltl mod] x)
</span><a href="#local-6989586621679188756"><span class="hs-identifier hs-var hs-var">interpretUnmodified</span></a></span></span><span> </span><span id="local-6989586621679188771"><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188771"><span class="hs-identifier hs-var">later</span></a></span></span><span> </span><span id="local-6989586621679188772"><span class="annot"><span class="annottext">op (AST ops) a
</span><a href="#local-6989586621679188772"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-449"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ltl mod] -&gt; Const [Ltl mod] x
forall {k} a (b :: k). a -&gt; Const a b
</span><span class="hs-identifier hs-var">Const</span></span><span> </span><span class="annot"><span class="annottext">[Ltl mod]
</span><a href="#local-6989586621679188771"><span class="hs-identifier hs-var">later</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>        </span><span class="annot"><span class="annottext">(a -&gt; (a, Const [Ltl mod] x)) -&gt; m a -&gt; m (a, Const [Ltl mod] x)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(forall b. AST ops b -&gt; m b) -&gt; op (AST ops) a -&gt; m a
forall (ops :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(forall b. AST ops b -&gt; m b) -&gt; op (AST ops) a -&gt; m a
forall (m :: * -&gt; *) (op :: (* -&gt; *) -&gt; * -&gt; *)
       (ops :: [(* -&gt; *) -&gt; * -&gt; *]) a.
InterpretEffect m op =&gt;
(forall b. AST ops b -&gt; m b) -&gt; op (AST ops) a -&gt; m a
</span><a href="Effect.Internal.html#interpretEffect"><span class="hs-identifier hs-var">interpretEffect</span></a></span><span>
</span><span id="line-451"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((b, Const [Ltl mod] Any) -&gt; b)
-&gt; m (b, Const [Ltl mod] Any) -&gt; m b
forall a b. (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(b, Const [Ltl mod] Any) -&gt; b
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(m (b, Const [Ltl mod] Any) -&gt; m b)
-&gt; (AST ops b -&gt; m (b, Const [Ltl mod] Any)) -&gt; AST ops b -&gt; m b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Const [Ltl mod] Any -&gt; AST ops b -&gt; m (b, Const [Ltl mod] Any)
forall b y.
Const [Ltl mod] y -&gt; AST ops b -&gt; m (b, Const [Ltl mod] y)
</span><a href="#local-6989586621679188752"><span class="hs-identifier hs-var">evalActs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ltl mod] -&gt; Const [Ltl mod] Any
forall {k} a (b :: k). a -&gt; Const a b
</span><span class="hs-identifier hs-var">Const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>          </span><span class="annot"><span class="annottext">op (AST ops) a
</span><a href="#local-6989586621679188772"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="hs-comment">-- | Internal: Split an LTL formula that describes a modification of a</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- computation into a list of @(doNow, doLater)@ pairs. This is used mostly to</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- implement 'nowLaterList', so see the comment there.</span><span>
</span><span id="line-457"></span><span id="local-6989586621679188366"><span class="annot"><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-type">nowLater</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679188366"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188366"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679188366"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188366"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-458"></span><span id="nowLater"><span class="annot"><span class="annottext">nowLater :: forall a. Semigroup a =&gt; Ltl a -&gt; [(Maybe a, Ltl a)]
</span><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var hs-var">nowLater</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="Logic.Ltl.html#LtlTruth"><span class="hs-identifier hs-var">LtlTruth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ltl a
forall a. Ltl a
</span><a href="Logic.Ltl.html#LtlTruth"><span class="hs-identifier hs-var">LtlTruth</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-459"></span><span class="annot"><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="Logic.Ltl.html#LtlFalsity"><span class="hs-identifier hs-var">LtlFalsity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-460"></span><span class="annot"><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#LtlAtom"><span class="hs-identifier hs-type">LtlAtom</span></a></span><span> </span><span id="local-6989586621679188784"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188784"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188784"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ltl a
forall a. Ltl a
</span><a href="Logic.Ltl.html#LtlTruth"><span class="hs-identifier hs-var">LtlTruth</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-461"></span><span class="annot"><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188785"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188785"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Logic.Ltl.html#LtlOr"><span class="hs-operator hs-type">`LtlOr`</span></a></span><span> </span><span id="local-6989586621679188786"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188786"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; [(Maybe a, Ltl a)]
forall a. Semigroup a =&gt; Ltl a -&gt; [(Maybe a, Ltl a)]
</span><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188785"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[(Maybe a, Ltl a)] -&gt; [(Maybe a, Ltl a)] -&gt; [(Maybe a, Ltl a)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; [(Maybe a, Ltl a)]
forall a. Semigroup a =&gt; Ltl a -&gt; [(Maybe a, Ltl a)]
</span><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188786"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-462"></span><span class="annot"><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188787"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188787"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Logic.Ltl.html#LtlAnd"><span class="hs-operator hs-type">`LtlAnd`</span></a></span><span> </span><span id="local-6989586621679188788"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188788"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679188789"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Maybe a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679188790"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-464"></span><span>      </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#ltlSimpl"><span class="hs-identifier hs-var">ltlSimpl</span></a></span><span> </span><span class="annot"><span class="annottext">(Ltl a -&gt; Ltl a) -&gt; Ltl a -&gt; Ltl a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188792"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlAnd"><span class="hs-operator hs-var">`LtlAnd`</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188793"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188789"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679188789"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188792"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188792"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; [(Maybe a, Ltl a)]
forall a. Semigroup a =&gt; Ltl a -&gt; [(Maybe a, Ltl a)]
</span><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188787"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-467"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679188790"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679188790"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188793"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188793"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; [(Maybe a, Ltl a)]
forall a. Semigroup a =&gt; Ltl a -&gt; [(Maybe a, Ltl a)]
</span><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188788"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-469"></span><span class="annot"><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#LtlNext"><span class="hs-identifier hs-type">LtlNext</span></a></span><span> </span><span id="local-6989586621679188794"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188794"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188794"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-470"></span><span class="annot"><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188795"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188795"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Logic.Ltl.html#LtlUntil"><span class="hs-operator hs-type">`LtlUntil`</span></a></span><span> </span><span id="local-6989586621679188796"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188796"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><span class="annottext">Ltl a -&gt; [(Maybe a, Ltl a)]
forall a. Semigroup a =&gt; Ltl a -&gt; [(Maybe a, Ltl a)]
</span><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span> </span><span class="annot"><span class="annottext">(Ltl a -&gt; [(Maybe a, Ltl a)]) -&gt; Ltl a -&gt; [(Maybe a, Ltl a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188796"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlOr"><span class="hs-operator hs-var">`LtlOr`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188795"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlAnd"><span class="hs-operator hs-var">`LtlAnd`</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlNext"><span class="hs-identifier hs-var">LtlNext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188795"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlUntil"><span class="hs-operator hs-var">`LtlUntil`</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188796"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span class="annot"><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188797"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188797"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Logic.Ltl.html#LtlRelease"><span class="hs-operator hs-type">`LtlRelease`</span></a></span><span> </span><span id="local-6989586621679188798"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188798"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-473"></span><span>  </span><span class="annot"><span class="annottext">Ltl a -&gt; [(Maybe a, Ltl a)]
forall a. Semigroup a =&gt; Ltl a -&gt; [(Maybe a, Ltl a)]
</span><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span> </span><span class="annot"><span class="annottext">(Ltl a -&gt; [(Maybe a, Ltl a)]) -&gt; Ltl a -&gt; [(Maybe a, Ltl a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188798"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlAnd"><span class="hs-operator hs-var">`LtlAnd`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188797"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlOr"><span class="hs-operator hs-var">`LtlOr`</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlNext"><span class="hs-identifier hs-var">LtlNext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188797"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlRelease"><span class="hs-operator hs-var">`LtlRelease`</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188798"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="hs-comment">-- | Internal: If there are no more steps and the next step should satisfy the</span><span>
</span><span id="line-476"></span><span class="hs-comment">-- given formula: Are we finished, i.e. was the initial formula satisfied by</span><span>
</span><span id="line-477"></span><span class="hs-comment">-- now?</span><span>
</span><span id="line-478"></span><span id="local-6989586621679188122"><span class="annot"><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-type">finished</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188122"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-479"></span><span id="finished"><span class="annot"><span class="annottext">finished :: forall a. Ltl a -&gt; Bool
</span><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var hs-var">finished</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="Logic.Ltl.html#LtlTruth"><span class="hs-identifier hs-var">LtlTruth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-480"></span><span class="annot"><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var">finished</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="Logic.Ltl.html#LtlFalsity"><span class="hs-identifier hs-var">LtlFalsity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-481"></span><span class="annot"><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var">finished</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#LtlAtom"><span class="hs-identifier hs-type">LtlAtom</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-482"></span><span class="annot"><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var">finished</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188799"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188799"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Logic.Ltl.html#LtlAnd"><span class="hs-operator hs-type">`LtlAnd`</span></a></span><span> </span><span id="local-6989586621679188800"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188800"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Bool
forall a. Ltl a -&gt; Bool
</span><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var">finished</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188799"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Bool
forall a. Ltl a -&gt; Bool
</span><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var">finished</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188800"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-483"></span><span class="annot"><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var">finished</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188802"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188802"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="Logic.Ltl.html#LtlOr"><span class="hs-operator hs-type">`LtlOr`</span></a></span><span> </span><span id="local-6989586621679188803"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188803"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Bool
forall a. Ltl a -&gt; Bool
</span><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var">finished</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188802"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Bool
forall a. Ltl a -&gt; Bool
</span><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var">finished</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188803"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-484"></span><span class="annot"><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var">finished</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#LtlNext"><span class="hs-identifier hs-type">LtlNext</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-485"></span><span class="annot"><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var">finished</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#LtlUntil"><span class="hs-identifier hs-type">LtlUntil</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-486"></span><span class="annot"><a href="Logic.Ltl.html#finished"><span class="hs-identifier hs-var">finished</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#LtlRelease"><span class="hs-identifier hs-type">LtlRelease</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="hs-comment">-- | We're passing around a list of 'Ltl' formulas from each time</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- step to the next.</span><span>
</span><span id="line-490"></span><span class="hs-comment">--</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- This function returns computes a list of @(doNow, doLater)@ pairs, where</span><span>
</span><span id="line-492"></span><span class="hs-comment">--</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- * @doNow@ is @Just@ the modification to be applied to the current time step,</span><span>
</span><span id="line-494"></span><span class="hs-comment">--   or @Nothing@, if no modification needs to be applied, and</span><span>
</span><span id="line-495"></span><span class="hs-comment">--</span><span>
</span><span id="line-496"></span><span class="hs-comment">-- * @doLater@ is again a list of 'Ltl' formulas describing the composite modification that</span><span>
</span><span id="line-497"></span><span class="hs-comment">--   should be applied from the next time step onwards.</span><span>
</span><span id="line-498"></span><span class="hs-comment">--</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- The return value is a list because a formula might be satisfied in different</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- ways. For example, the modification described by @a `LtlUntil` b@ might be</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- accomplished by applying the modification @b@ right now, or by applying @a@</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- right now and @a `LtlUntil` b@ from the next step onwards; the returned list</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- will contain these two options.</span><span>
</span><span id="line-504"></span><span class="hs-comment">--</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- Atomic modifications of type @a@ should form a 'Semigroup', where '&lt;&gt;' is</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- the composition of modifications. We interpret @x &lt;&gt; y@ as the modification</span><span>
</span><span id="line-507"></span><span class="hs-comment">-- that first applies @y@ and then @x@. Attention: Since we use '&lt;&gt;' to define</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- conjunction, if '&lt;&gt;' is not commutative, conjunction will also fail to be</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- commutative!</span><span>
</span><span id="line-510"></span><span id="local-6989586621679188339"><span class="annot"><a href="Logic.Ltl.html#nowLaterList"><span class="hs-identifier hs-type">nowLaterList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679188339"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188339"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679188339"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188339"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-511"></span><span id="nowLaterList"><span class="annot"><span class="annottext">nowLaterList :: forall a. Semigroup a =&gt; [Ltl a] -&gt; [(Maybe a, [Ltl a])]
</span><a href="Logic.Ltl.html#nowLaterList"><span class="hs-identifier hs-var hs-var">nowLaterList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(Maybe a, Ltl a)]] -&gt; [(Maybe a, [Ltl a])]
forall {a} {a}. Monoid a =&gt; [[(a, a)]] -&gt; [(a, [a])]
</span><a href="#local-6989586621679188809"><span class="hs-identifier hs-var">joinNowLaters</span></a></span><span> </span><span class="annot"><span class="annottext">([[(Maybe a, Ltl a)]] -&gt; [(Maybe a, [Ltl a])])
-&gt; ([Ltl a] -&gt; [[(Maybe a, Ltl a)]])
-&gt; [Ltl a]
-&gt; [(Maybe a, [Ltl a])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Ltl a -&gt; [(Maybe a, Ltl a)]) -&gt; [Ltl a] -&gt; [[(Maybe a, Ltl a)]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; [(Maybe a, Ltl a)]
forall a. Semigroup a =&gt; Ltl a -&gt; [(Maybe a, Ltl a)]
</span><a href="Logic.Ltl.html#nowLater"><span class="hs-identifier hs-var">nowLater</span></a></span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-513"></span><span>    </span><span id="local-6989586621679188809"><span class="annot"><span class="annottext">joinNowLaters :: [[(a, a)]] -&gt; [(a, [a])]
</span><a href="#local-6989586621679188809"><span class="hs-identifier hs-var hs-var">joinNowLaters</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-514"></span><span>    </span><span class="annot"><a href="#local-6989586621679188809"><span class="hs-identifier hs-var">joinNowLaters</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188816"><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679188816"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679188817"><span class="annot"><span class="annottext">[[(a, a)]]
</span><a href="#local-6989586621679188817"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-515"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188818"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188819"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188820"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679188821"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188819"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188819"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188820"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188820"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679188816"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-517"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679188818"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188818"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188821"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679188821"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[(a, a)]] -&gt; [(a, [a])]
</span><a href="#local-6989586621679188809"><span class="hs-identifier hs-var">joinNowLaters</span></a></span><span> </span><span class="annot"><span class="annottext">[[(a, a)]]
</span><a href="#local-6989586621679188817"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-518"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span id="local-6989586621679188377"><span id="local-6989586621679188378"><span id="local-6989586621679188379"><span class="annot"><a href="Logic.Ltl.html#nowLaterSplit"><span class="hs-identifier hs-type">nowLaterSplit</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679188377"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadPlus</span></span><span> </span><span class="annot"><a href="#local-6989586621679188378"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-522"></span><span>  </span><span class="annot"><a href="#local-6989586621679188378"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188379"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188377"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188378"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679188379"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188377"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-525"></span><span>  </span><span class="annot"><a href="#local-6989586621679188378"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188379"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188377"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-526"></span><span id="nowLaterSplit"><span class="annot"><span class="annottext">nowLaterSplit :: forall x (m :: * -&gt; *) a.
(Semigroup x, MonadPlus m) =&gt;
m a -&gt; (x -&gt; m (Maybe a)) -&gt; [Ltl x] -&gt; m (a, [Ltl x])
</span><a href="Logic.Ltl.html#nowLaterSplit"><span class="hs-identifier hs-var hs-var">nowLaterSplit</span></a></span></span><span> </span><span id="local-6989586621679188835"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679188835"><span class="hs-identifier hs-var">defaultBehaviour</span></a></span></span><span> </span><span id="local-6989586621679188836"><span class="annot"><span class="annottext">x -&gt; m (Maybe a)
</span><a href="#local-6989586621679188836"><span class="hs-identifier hs-var">applyMod</span></a></span></span><span> </span><span id="local-6989586621679188837"><span class="annot"><span class="annottext">[Ltl x]
</span><a href="#local-6989586621679188837"><span class="hs-identifier hs-var">formulas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-527"></span><span>  </span><span class="annot"><span class="annottext">[m (a, [Ltl x])] -&gt; m (a, [Ltl x])
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span> </span><span class="annot"><span class="annottext">([m (a, [Ltl x])] -&gt; m (a, [Ltl x]))
-&gt; [m (a, [Ltl x])] -&gt; m (a, [Ltl x])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-528"></span><span>    </span><span class="annot"><span class="annottext">((Maybe x, [Ltl x]) -&gt; m (a, [Ltl x]))
-&gt; [(Maybe x, [Ltl x])] -&gt; [m (a, [Ltl x])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-529"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679188838"><span class="annot"><span class="annottext">Maybe x
</span><a href="#local-6989586621679188838"><span class="hs-identifier hs-var">now</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188839"><span class="annot"><span class="annottext">[Ltl x]
</span><a href="#local-6989586621679188839"><span class="hs-identifier hs-var">later</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe x
</span><a href="#local-6989586621679188838"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-530"></span><span>          </span><span class="annot"><span class="annottext">Maybe x
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ltl x]
</span><a href="#local-6989586621679188839"><span class="hs-identifier hs-var">later</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, [Ltl x])) -&gt; m a -&gt; m (a, [Ltl x])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679188835"><span class="hs-identifier hs-var">defaultBehaviour</span></a></span><span>
</span><span id="line-531"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679188840"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679188840"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-532"></span><span>            </span><span id="local-6989586621679188841"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679188841"><span class="hs-identifier hs-var">mA</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">x -&gt; m (Maybe a)
</span><a href="#local-6989586621679188836"><span class="hs-identifier hs-var">applyMod</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679188840"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-533"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679188841"><span class="hs-identifier hs-var">mA</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-534"></span><span>              </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (a, [Ltl x])
forall a. m a
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a
</span><span class="hs-identifier hs-var">mzero</span></span><span>
</span><span id="line-535"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679188842"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188842"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, [Ltl x]) -&gt; m (a, [Ltl x])
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188842"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ltl x]
</span><a href="#local-6989586621679188839"><span class="hs-identifier hs-var">later</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ltl x] -&gt; [(Maybe x, [Ltl x])]
forall a. Semigroup a =&gt; [Ltl a] -&gt; [(Maybe a, [Ltl a])]
</span><a href="Logic.Ltl.html#nowLaterList"><span class="hs-identifier hs-var">nowLaterList</span></a></span><span> </span><span class="annot"><span class="annottext">[Ltl x]
</span><a href="#local-6989586621679188837"><span class="hs-identifier hs-var">formulas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="hs-comment">-- | Internal: Straightforward simplification procedure for LTL formulas. This</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- function knows how 'LtlTruth' and 'LtlFalsity' play with conjunction and</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- disjunction and recursively applies this knowledge; it does not do anything</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- &quot;fancy&quot; like computing a normal form and is only used to keep the formulas</span><span>
</span><span id="line-543"></span><span class="hs-comment">-- 'nowLater' generates from growing too wildly.</span><span>
</span><span id="line-544"></span><span id="local-6989586621679188843"><span class="annot"><a href="Logic.Ltl.html#ltlSimpl"><span class="hs-identifier hs-type">ltlSimpl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188843"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188843"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-545"></span><span id="ltlSimpl"><span class="annot"><span class="annottext">ltlSimpl :: forall a. Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#ltlSimpl"><span class="hs-identifier hs-var hs-var">ltlSimpl</span></a></span></span><span> </span><span id="local-6989586621679188844"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188844"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188845"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188845"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188846"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188846"><span class="hs-identifier hs-var">progress</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; (Ltl a, Bool)
forall a. Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188847"><span class="hs-identifier hs-var">simpl</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188844"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-547"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188846"><span class="hs-identifier hs-var">progress</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188845"><span class="hs-identifier hs-var">expr'</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188844"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-549"></span><span>    </span><span id="local-6989586621679188384"><span class="annot"><a href="#local-6989586621679188847"><span class="hs-identifier hs-type">simpl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188384"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188384"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-550"></span><span>    </span><span id="local-6989586621679188847"><span class="annot"><span class="annottext">simpl :: forall a. Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188847"><span class="hs-identifier hs-var hs-var">simpl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#LtlAnd"><span class="hs-identifier hs-type">LtlAnd</span></a></span><span> </span><span id="local-6989586621679188848"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188848"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679188849"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188849"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; (Ltl a, Bool)
forall a. Ltl a -&gt; Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188850"><span class="hs-identifier hs-var">simplAnd</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188848"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188849"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span class="annot"><a href="#local-6989586621679188847"><span class="hs-identifier hs-var">simpl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#LtlOr"><span class="hs-identifier hs-type">LtlOr</span></a></span><span> </span><span id="local-6989586621679188851"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188851"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679188852"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188852"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; (Ltl a, Bool)
forall a. Ltl a -&gt; Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188853"><span class="hs-identifier hs-var">simplOr</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188851"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188852"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-552"></span><span>    </span><span class="annot"><a href="#local-6989586621679188847"><span class="hs-identifier hs-var">simpl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#LtlNext"><span class="hs-identifier hs-type">LtlNext</span></a></span><span> </span><span id="local-6989586621679188854"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188854"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-553"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188855"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188855"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188856"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188856"><span class="hs-identifier hs-var">pa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; (Ltl a, Bool)
forall a. Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188847"><span class="hs-identifier hs-var">simpl</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188854"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-554"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188856"><span class="hs-identifier hs-var">pa</span></a></span><span>
</span><span id="line-555"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlNext"><span class="hs-identifier hs-var">LtlNext</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188855"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlNext"><span class="hs-identifier hs-var">LtlNext</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188854"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>    </span><span class="annot"><a href="#local-6989586621679188847"><span class="hs-identifier hs-var">simpl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#LtlUntil"><span class="hs-identifier hs-type">LtlUntil</span></a></span><span> </span><span id="local-6989586621679188857"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188857"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679188858"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188858"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ltl a -&gt; Ltl a -&gt; Ltl a) -&gt; Ltl a -&gt; Ltl a -&gt; (Ltl a, Bool)
forall a.
(Ltl a -&gt; Ltl a -&gt; Ltl a) -&gt; Ltl a -&gt; Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188859"><span class="hs-identifier hs-var">recurse2</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlUntil"><span class="hs-identifier hs-var">LtlUntil</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188857"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188858"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-558"></span><span>    </span><span class="annot"><a href="#local-6989586621679188847"><span class="hs-identifier hs-var">simpl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#LtlRelease"><span class="hs-identifier hs-type">LtlRelease</span></a></span><span> </span><span id="local-6989586621679188860"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188860"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679188861"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188861"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ltl a -&gt; Ltl a -&gt; Ltl a) -&gt; Ltl a -&gt; Ltl a -&gt; (Ltl a, Bool)
forall a.
(Ltl a -&gt; Ltl a -&gt; Ltl a) -&gt; Ltl a -&gt; Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188859"><span class="hs-identifier hs-var">recurse2</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlRelease"><span class="hs-identifier hs-var">LtlRelease</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188860"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188861"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-559"></span><span>    </span><span class="annot"><a href="#local-6989586621679188847"><span class="hs-identifier hs-var">simpl</span></a></span><span> </span><span id="local-6989586621679188862"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188862"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188862"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span>    </span><span id="local-6989586621679188386"><span class="annot"><a href="#local-6989586621679188850"><span class="hs-identifier hs-type">simplAnd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188386"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188386"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188386"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-562"></span><span>    </span><span id="local-6989586621679188850"><span class="annot"><span class="annottext">simplAnd :: forall a. Ltl a -&gt; Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188850"><span class="hs-identifier hs-var hs-var">simplAnd</span></a></span></span><span> </span><span id="local-6989586621679188863"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188863"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679188864"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188864"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-563"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188865"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188865"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188866"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188866"><span class="hs-identifier hs-var">pa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; (Ltl a, Bool)
forall a. Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188847"><span class="hs-identifier hs-var">simpl</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188863"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-564"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679188867"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188867"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188868"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188868"><span class="hs-identifier hs-var">pb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; (Ltl a, Bool)
forall a. Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188847"><span class="hs-identifier hs-var">simpl</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188864"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-565"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188865"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188867"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-566"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="Logic.Ltl.html#LtlTruth"><span class="hs-identifier hs-var">LtlTruth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188867"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="Logic.Ltl.html#LtlTruth"><span class="hs-identifier hs-var">LtlTruth</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188865"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="Logic.Ltl.html#LtlFalsity"><span class="hs-identifier hs-var">LtlFalsity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
forall a. Ltl a
</span><a href="Logic.Ltl.html#LtlFalsity"><span class="hs-identifier hs-var">LtlFalsity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="Logic.Ltl.html#LtlFalsity"><span class="hs-identifier hs-var">LtlFalsity</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
forall a. Ltl a
</span><a href="Logic.Ltl.html#LtlFalsity"><span class="hs-identifier hs-var">LtlFalsity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>            </span><span class="annot"><span class="annottext">(Ltl a, Ltl a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188866"><span class="hs-identifier hs-var">pa</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188868"><span class="hs-identifier hs-var">pb</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlAnd"><span class="hs-identifier hs-var">LtlAnd</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188865"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188867"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlAnd"><span class="hs-identifier hs-var">LtlAnd</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188863"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188864"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span>    </span><span id="local-6989586621679188869"><span class="annot"><a href="#local-6989586621679188853"><span class="hs-identifier hs-type">simplOr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188869"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188869"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188869"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-573"></span><span>    </span><span id="local-6989586621679188853"><span class="annot"><span class="annottext">simplOr :: forall a. Ltl a -&gt; Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188853"><span class="hs-identifier hs-var hs-var">simplOr</span></a></span></span><span> </span><span id="local-6989586621679188870"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188870"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679188871"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188871"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-574"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188872"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188872"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188873"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188873"><span class="hs-identifier hs-var">pa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; (Ltl a, Bool)
forall a. Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188847"><span class="hs-identifier hs-var">simpl</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188870"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-575"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679188874"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188874"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188875"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188875"><span class="hs-identifier hs-var">pb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; (Ltl a, Bool)
forall a. Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188847"><span class="hs-identifier hs-var">simpl</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188871"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-576"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188872"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188874"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-577"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="Logic.Ltl.html#LtlTruth"><span class="hs-identifier hs-var">LtlTruth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
forall a. Ltl a
</span><a href="Logic.Ltl.html#LtlTruth"><span class="hs-identifier hs-var">LtlTruth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="Logic.Ltl.html#LtlTruth"><span class="hs-identifier hs-var">LtlTruth</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
forall a. Ltl a
</span><a href="Logic.Ltl.html#LtlTruth"><span class="hs-identifier hs-var">LtlTruth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="Logic.Ltl.html#LtlFalsity"><span class="hs-identifier hs-var">LtlFalsity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188874"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="Logic.Ltl.html#LtlFalsity"><span class="hs-identifier hs-var">LtlFalsity</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188872"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>            </span><span class="annot"><span class="annottext">(Ltl a, Ltl a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188873"><span class="hs-identifier hs-var">pa</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188875"><span class="hs-identifier hs-var">pb</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlOr"><span class="hs-identifier hs-var">LtlOr</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188872"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188874"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
forall a. Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="Logic.Ltl.html#LtlOr"><span class="hs-identifier hs-var">LtlOr</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188870"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188871"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span>    </span><span id="local-6989586621679188387"><span class="annot"><a href="#local-6989586621679188859"><span class="hs-identifier hs-type">recurse2</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-584"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188387"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188387"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188387"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-585"></span><span>      </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188387"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-586"></span><span>      </span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188387"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-587"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Logic.Ltl.html#Ltl"><span class="hs-identifier hs-type">Ltl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188387"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-588"></span><span>    </span><span id="local-6989586621679188859"><span class="annot"><span class="annottext">recurse2 :: forall a.
(Ltl a -&gt; Ltl a -&gt; Ltl a) -&gt; Ltl a -&gt; Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188859"><span class="hs-identifier hs-var hs-var">recurse2</span></a></span></span><span> </span><span id="local-6989586621679188876"><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="#local-6989586621679188876"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679188877"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188877"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679188878"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188878"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-589"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188879"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188879"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188880"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188880"><span class="hs-identifier hs-var">pa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; (Ltl a, Bool)
forall a. Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188847"><span class="hs-identifier hs-var">simpl</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188877"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-590"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679188881"><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188881"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188882"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188882"><span class="hs-identifier hs-var">pb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ltl a -&gt; (Ltl a, Bool)
forall a. Ltl a -&gt; (Ltl a, Bool)
</span><a href="#local-6989586621679188847"><span class="hs-identifier hs-var">simpl</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188878"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-591"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188880"><span class="hs-identifier hs-var">pa</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679188882"><span class="hs-identifier hs-var">pb</span></a></span><span>
</span><span id="line-592"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="#local-6989586621679188876"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188879"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188881"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ltl a -&gt; Ltl a -&gt; Ltl a
</span><a href="#local-6989586621679188876"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188877"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Ltl a
</span><a href="#local-6989586621679188878"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span></pre></body></html>